<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >

<link rel="shortcut icon" href="http://www.uchicago.edu/favicon.ico"/>
<link href="../../../css/stylesheet.css" rel="stylesheet" type="text/css">

<body>
	<div id='container' class='container'>
		<div id='header' class='header' ></div>
		<div id='linksidebar' class='linksidebar' ></div>
		<div id='maincontent' class='maincontent' >
			<div id='pagetrail' class='pagetrail' ></div>
			<h1>Salmon Cranial Linkages</h1>
			
			<p>
			To run the example below, ensure that you have 
			<a href='http://rweb.quant.ku.edu/cran/' target='_blank' >R</a>
			installed on your system as well as the R packages 
			<a href='http://cran.r-project.org/web/packages/linkR/index.html' target='_blank' >linkR</a>
			and 
			<a href='http://cran.r-project.org/web/packages/svgViewR/index.html' target='_blank' >svgViewR</a>.
			Then, copy and paste the following code into the R console.
			</p>

			<div class='code' >
				<pre class='code'>
# Load the linkR library
library(linkR)

# Load example data for owl cranial linkages
salmon <- linkR_examples('salmon')

# Landmark data, joints used to construct the model and associated points for visualization
lm <- salmon$landmarks

# Link name with which each landmark is associated
lm.assoc <- salmon$lm.assoc

# Which points to connect with paths for easier visualization
path.connect <- salmon$path.connect

# Set joint coordinates
joint.coor <- lm[c('NC_VT', 'SUSP_NC_ANT_L', 'HYD_SUSP_L', 'HYD_BHYL_L', 
	'BHYL', 'HYD_BHYL_R', 'HYD_SUSP_R', 'SUSP_NC_ANT_R',
	'BHYL_LJ', 'LJ_BHYL', 'LJ_SYMPH_VEN', 'LJ_QUAD_L', 
	'LJ_SYMPH_L', 'LJ_SYMPH_R',	'LJ_QUAD_R'), ]

# Joint types
joint.types <- c("R", "R", "S", "S", 
	"P", "S", "S", "R", "S", "S", 
	"P", "S", "S", "S", "S")

# Joint constraint vectors
joint.cons <- list(
	lm['SUSP_NC_POS_L',]-lm['SUSP_NC_POS_R',], 
	lm['SUSP_NC_ANT_L',]-lm['SUSP_NC_POS_L',],NA,NA, 
	lm['SUSP_NC_ANT_L',]-lm['SUSP_NC_ANT_R',],NA,NA, 
	lm['SUSP_NC_ANT_R',]-lm['SUSP_NC_POS_R',],NA,NA,
	lm['SUSP_NC_ANT_L',]-lm['SUSP_NC_ANT_R',],NA,NA,NA,NA)

# The links connected by each joint
joint.conn <- rbind(
	c('vert_column', 'neurocranium'), c('neurocranium', 'suspensorium_L'), 
	c('suspensorium_L', 'hyoid_L'), c('hyoid_L', 'basihyal'), 
	c('basihyal', 'vert_column'), c('basihyal', 'hyoid_R'), 
	c('hyoid_R', 'suspensorium_R'), c('suspensorium_R', 'neurocranium'),
	c('basihyal', 'hyoid_lowerjaw'), c('hyoid_lowerjaw', 'lowerjaw_symph'), 
	c('lowerjaw_symph', 'vert_column'), c('suspensorium_L', 'lowerjaw_L'),
	c('lowerjaw_L', 'lowerjaw_symph'), c('lowerjaw_symph', 'lowerjaw_R'), 
	c('lowerjaw_R', 'suspensorium_R')
)

# Set long axis rotation constraints
lar_vec <- lm['SUSP_NC_POS_L',]-lm['SUSP_NC_POS_R',];
lar.cons <- list(
	list('link'='lowerjaw_L','type'='P','point'=lm['LJ_SYMPH_DOR',], 'vec'=lar_vec),
	list('link'='lowerjaw_R','type'='P','point'=lm['LJ_SYMPH_DOR',], 'vec'=lar_vec),
	list('link'='hyoid_R','type'='P','point'=lm['URO_HYP_DOR_R',], 'vec'=lar_vec),
	list('link'='hyoid_L','type'='P','point'=lm['URO_HYP_DOR_L',], 'vec'=lar_vec)
)

# Define the linkage
linkage <- defineLinkage(joint.coor=joint.coor, joint.types=joint.types, 
	joint.cons=joint.cons, joint.conn, points=lm, link.assoc=lm.assoc, 
	ground.link='vert_column', lar.cons=lar.cons)

# Set the animation input parameters
anim_len <- 100;
hyoid_tvec <- c(-1,0,0);
input.param <- list(
	seq(from=0*(pi/180), to=8*(pi/180), length=anim_len),
	rbind(matrix(uvector(hyoid_tvec), nrow=anim_len, ncol=3, byrow=TRUE)*
		matrix(seq(0, 3, length=anim_len), nrow=anim_len, ncol=3)
	)
)

# Animate the linkage
animate <- animateLinkage(linkage, input.param=input.param, input.joint=c(1,5))

# Create an interactive linkage visualization
drawLinkage(animate, file="salmon", animate=TRUE, 
	window.title="Salmon cranial linkages", animate.duration=3, 
	animate.reverse=TRUE, connect.joints=FALSE,
	path.connect=path.connect, point.cex=0.3, joint.cex=1, path.lwd=1)
</pre>
			</div>
			<p>
			This will create an 
			<a href='salmon.html' >interactive visualization</a> as an '.html' file that can be opened in any 
			compatible web browser. See
			<a href='../../svgviewr/interactive.shtml' >
			svgViewR Interactive Commands
			</a>
			for instructions on how to interact with svgViewR animations.
			</p>
			<br /><br />

		</div>
		<div id='footer' class='footer' ></div>
	</div>
</body>

<script src="../../../js/sharedfunctions.js" type="text/javascript" ></script>