<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<title>RRSS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >

<svg_doc xmlns="http://www.w3.org/2000/svg" version="1.1" style="visibility:hidden;" >
	<point z-index="0" layer="" x="0" y="0" z="0" label="" r="1.5" stroke="black" stroke-width="2" fill="white" fill-opacity="1" stroke-opacity="1" />
	<point z-index="0" layer="" x="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0" y="1,0.99987413,0.99949654,0.99886734,0.99798668,0.99685478,0.99547192,0.99383846,0.99195481,0.98982144,0.98743889,0.98480775,0.9819287,0.97880245,0.97542979,0.97181157,0.9679487,0.96384216,0.95949297,0.95490224,0.95007112,0.94500082,0.93969262,0.93414786,0.92836793,0.92235429,0.91610846,0.909632,0.90292654,0.89599377,0.88883545,0.88145336,0.87384938,0.8660254,0.85798341,0.84972543,0.84125353,0.83256985,0.82367658,0.81457595,0.80527026,0.79576184,0.78605309,0.77614646,0.76604444,0.75574957,0.74526445,0.73459171,0.72373404,0.71269417,0.70147489,0.69007901,0.67850941,0.666769,0.65486073,0.64278761,0.63055267,0.61815899,0.60560969,0.59290793,0.58005691,0.56705986,0.55392006,0.54064082,0.52722547,0.51367739,0.5,0.48619674,0.47227107,0.45822652,0.44406661,0.42979491,0.41541501,0.40093054,0.38634513,0.37166246,0.35688622,0.34202014,0.32706796,0.31203345,0.29692038,0.28173256,0.26647381,0.25114799,0.23575894,0.22031053,0.20480667,0.18925124,0.17364818,0.1580014,0.14231484,0.12659245,0.1108382,0.09505604,0.07924996,0.06342392,0.04758192,0.03172793,0.01586596,0" z="0,-0.01586596,-0.03172793,-0.04758192,-0.06342392,-0.07924996,-0.09505604,-0.1108382,-0.12659245,-0.14231484,-0.1580014,-0.17364818,-0.18925124,-0.20480667,-0.22031053,-0.23575894,-0.25114799,-0.26647381,-0.28173256,-0.29692038,-0.31203345,-0.32706796,-0.34202014,-0.35688622,-0.37166246,-0.38634513,-0.40093054,-0.41541501,-0.42979491,-0.44406661,-0.45822652,-0.47227107,-0.48619674,-0.5,-0.51367739,-0.52722547,-0.54064082,-0.55392006,-0.56705986,-0.58005691,-0.59290793,-0.60560969,-0.61815899,-0.63055267,-0.64278761,-0.65486073,-0.666769,-0.67850941,-0.69007901,-0.70147489,-0.71269417,-0.72373404,-0.73459171,-0.74526445,-0.75574957,-0.76604444,-0.77614646,-0.78605309,-0.79576184,-0.80527026,-0.81457595,-0.82367658,-0.83256985,-0.84125353,-0.84972543,-0.85798341,-0.8660254,-0.87384938,-0.88145336,-0.88883545,-0.89599377,-0.90292654,-0.909632,-0.91610846,-0.92235429,-0.92836793,-0.93414786,-0.93969262,-0.94500082,-0.95007112,-0.95490224,-0.95949297,-0.96384216,-0.9679487,-0.97181157,-0.97542979,-0.97880245,-0.9819287,-0.98480775,-0.98743889,-0.98982144,-0.99195481,-0.99383846,-0.99547192,-0.99685478,-0.99798668,-0.99886734,-0.99949654,-0.99987413,-1" label="" r="1.5" stroke="black" stroke-width="2" fill="white" fill-opacity="1" stroke-opacity="1" />
	<point z-index="0" layer="" x="1,1.00012586,1.00050333,1.00113202,1.00201129,1.00314027,1.0045178,1.00614249,1.00801269,1.01012649,1.01248173,1.01507597,1.01790655,1.02097053,1.0242647,1.02778562,1.03152956,1.03549255,1.03967034,1.04405845,1.04865211,1.05344631,1.05843576,1.06361492,1.06897801,1.07451896,1.08023148,1.08610902,1.09214476,1.09833166,1.10466243,1.11112955,1.11772526,1.12444159,1.13127034,1.13820311,1.14523127,1.15234604,1.15953843,1.16679928,1.17411927,1.18148892,1.18889864,1.19633868,1.20379921,1.21127029,1.2187419,1.22620397,1.23364638,1.24105898,1.24843161,1.25575412,1.2630164,1.27020837,1.27732004,1.2843415,1.29126295,1.29807472,1.30476729,1.31133133,1.31775767,1.32403739,1.33016178,1.33612238,1.34191103,1.34751982,1.35294118,1.35816784,1.36319291,1.36800981,1.37261235,1.37699473,1.38115154,1.38507777,1.38876883,1.39222055,1.3954292,1.39839146,1.40110448,1.40356584,1.40577355,1.40772608,1.40942234,1.41086166,1.41204383,1.41296905,1.41363794,1.41405156,1.41421134,1.41411913,1.41377716,1.41318801,1.41235465,1.41128038,1.40996882,1.40842392,1.40664992,1.40465137,1.40243304,1.4" y="2,1.99962239,1.99848975,1.99660266,1.99396206,1.9905693,1.98642609,1.98153455,1.97589719,1.96951692,1.96239704,1.95454128,1.94595379,1.93663912,1.92660229,1.91584872,1.9043843,1.8922154,1.87934882,1.86579187,1.85155232,1.83663845,1.82105905,1.80482343,1.7879414,1.77042333,1.75228012,1.73352321,1.71416462,1.69421691,1.67369321,1.65260725,1.63097329,1.60880621,1.58612144,1.56293501,1.53926351,1.5151241,1.49053453,1.46551309,1.44007862,1.41425051,1.38804868,1.36149355,1.33460605,1.30740757,1.27991998,1.25216556,1.22416701,1.19594739,1.16753014,1.13893899,1.11019797,1.08133136,1.05236363,1.02331945,0.99422361,0.96510097,0.93597647,0.90687501,0.87782149,0.84884068,0.81995723,0.7911956,0.76258,0.73413438,0.70588235,0.67784714,0.65005156,0.62251793,0.59526809,0.56832329,0.5417042,0.51543083,0.48952253,0.46399791,0.43887485,0.41417044,0.38990097,0.36608187,0.34272771,0.3198522,0.29746813,0.27558737,0.25422087,0.23337863,0.21306972,0.19330223,0.17408335,0.15541926,0.13731526,0.11977566,0.10280389,0.08640245,0.07057292,0.05531605,0.0406317,0.02651889,0.01297585,0" z="0,-0.03172993,-0.06343989,-0.09510991,-0.12672002,-0.15825026,-0.18968069,-0.22099137,-0.25216237,-0.28317378,-0.31400573,-0.34463836,-0.37505185,-0.40522642,-0.43514232,-0.46477987,-0.49411945,-0.52314152,-0.5518266,-0.58015533,-0.60810842,-0.63566675,-0.66281129,-0.68952319,-0.71578376,-0.7415745,-0.76687711,-0.79167352,-0.81594593,-0.83967678,-0.86284882,-0.88544514,-0.90744917,-0.9288447,-0.94961594,-0.96974754,-0.98922459,-1.0080327,-1.02615799,-1.04358715,-1.06030742,-1.07630671,-1.09157355,-1.10609715,-1.11986744,-1.13287511,-1.1451116,-1.15656917,-1.16724088,-1.1771207,-1.18620344,-1.19448484,-1.20196155,-1.2086312,-1.21449237,-1.21954463,-1.22378855,-1.22722572,-1.22985872,-1.23169119,-1.2327278,-1.23297421,-1.23243716,-1.23112438,-1.22904461,-1.2262076,-1.2226241,-1.2183058,-1.21326535,-1.20751633,-1.20107319,-1.19395128,-1.18616674,-1.17773655,-1.1686784,-1.15901074,-1.14875267,-1.13792394,-1.12654486,-1.1146363,-1.10221961,-1.08931657,-1.07594935,-1.06214046,-1.0479127,-1.03328909,-1.01829282,-1.00294723,-0.98727571,-0.9713017,-0.95504859,-0.93853972,-0.92179829,-0.90484734,-0.8877097,-0.87040794,-0.85296433,-0.83540083,-0.81773899,-0.8" label="" r="1.5" stroke="black" stroke-width="2" fill="white" fill-opacity="1" stroke-opacity="1" />
	<point z-index="0" layer="" x="2" y="1" z="0" label="" r="1.5" stroke="black" stroke-width="2" fill="white" fill-opacity="1" stroke-opacity="1" />
	<pathC z-index="0" layer="" label="" stroke="black" stroke-width="1" stroke-opacity="1" fill="none" fill-opacity="1" d="1,2" />
	<pathC z-index="0" layer="" label="" stroke="black" stroke-width="1" stroke-opacity="1" fill="none" fill-opacity="1" d="2,3" />
	<pathC z-index="0" layer="" label="" stroke="black" stroke-width="1" stroke-opacity="1" fill="none" fill-opacity="1" d="3,4" />
	<point z-index="0" layer="" x="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0" y="0,0.0015866,0.00317279,0.00475819,0.00634239,0.007925,0.0095056,0.01108382,0.01265925,0.01423148,0.01580014,0.01736482,0.01892512,0.02048067,0.02203105,0.02357589,0.0251148,0.02664738,0.02817326,0.02969204,0.03120334,0.0327068,0.03420201,0.03568862,0.03716625,0.03863451,0.04009305,0.0415415,0.04297949,0.04440666,0.04582265,0.04722711,0.04861967,0.05,0.05136774,0.05272255,0.05406408,0.05539201,0.05670599,0.05800569,0.05929079,0.06056097,0.0618159,0.06305527,0.06427876,0.06548607,0.0666769,0.06785094,0.0690079,0.07014749,0.07126942,0.0723734,0.07345917,0.07452644,0.07557496,0.07660444,0.07761465,0.07860531,0.07957618,0.08052703,0.0814576,0.08236766,0.08325699,0.08412535,0.08497254,0.08579834,0.08660254,0.08738494,0.08814534,0.08888354,0.08959938,0.09029265,0.0909632,0.09161085,0.09223543,0.09283679,0.09341479,0.09396926,0.09450008,0.09500711,0.09549022,0.0959493,0.09638422,0.09679487,0.09718116,0.09754298,0.09788024,0.09819287,0.09848078,0.09874389,0.09898214,0.09919548,0.09938385,0.09954719,0.09968548,0.09979867,0.09988673,0.09994965,0.09998741,0.1" z="0.1,0.09998741,0.09994965,0.09988673,0.09979867,0.09968548,0.09954719,0.09938385,0.09919548,0.09898214,0.09874389,0.09848078,0.09819287,0.09788024,0.09754298,0.09718116,0.09679487,0.09638422,0.0959493,0.09549022,0.09500711,0.09450008,0.09396926,0.09341479,0.09283679,0.09223543,0.09161085,0.0909632,0.09029265,0.08959938,0.08888354,0.08814534,0.08738494,0.08660254,0.08579834,0.08497254,0.08412535,0.08325699,0.08236766,0.0814576,0.08052703,0.07957618,0.07860531,0.07761465,0.07660444,0.07557496,0.07452644,0.07345917,0.0723734,0.07126942,0.07014749,0.0690079,0.06785094,0.0666769,0.06548607,0.06427876,0.06305527,0.0618159,0.06056097,0.05929079,0.05800569,0.05670599,0.05539201,0.05406408,0.05272255,0.05136774,0.05,0.04861967,0.04722711,0.04582265,0.04440666,0.04297949,0.0415415,0.04009305,0.03863451,0.03716625,0.03568862,0.03420201,0.0327068,0.03120334,0.02969204,0.02817326,0.02664738,0.0251148,0.02357589,0.02203105,0.02048067,0.01892512,0.01736482,0.01580014,0.01423148,0.01265925,0.01108382,0.0095056,0.007925,0.00634239,0.00475819,0.00317279,0.0015866,0" label="" r="1" stroke="black" stroke-width="2" fill="black" fill-opacity="1" stroke-opacity="1" />
	<point z-index="0" layer="" x="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0" y="1,1.00146072,1.00266934,1.00362553,1.00432907,1.00477977,1.00497753,1.00492228,1.00461406,1.00405293,1.00323903,1.00217257,1.00085382,0.99928311,0.99746084,0.99538746,0.9930635,0.99048954,0.98766623,0.98459428,0.98127446,0.97770762,0.97389464,0.96983648,0.96553418,0.96098881,0.95620151,0.9511735,0.94590603,0.94040044,0.9346581,0.92868047,0.92246905,0.9160254,0.90935115,0.90244798,0.89531761,0.88796186,0.88038257,0.87258164,0.86456105,0.85632281,0.84786899,0.83920173,0.8303232,0.82123565,0.81194135,0.80244265,0.79274194,0.78284166,0.7727443,0.76245242,0.75196858,0.74129545,0.73043569,0.71939205,0.70816731,0.6967643,0.68518587,0.67343495,0.6615145,0.64942752,0.63717705,0.62476617,0.61219801,0.59947573,0.58660254,0.57358167,0.56041641,0.54711007,0.53366599,0.52008757,0.50637821,0.49254138,0.47858056,0.46449925,0.45030101,0.43598941,0.42156805,0.40704056,0.3924106,0.37768185,0.36285803,0.34794286,0.33294009,0.31785351,0.30268691,0.28744411,0.27212895,0.25674528,0.24129698,0.22578793,0.21022205,0.19460324,0.17893543,0.16322259,0.14746865,0.13167759,0.11585338,0.1" z="0.1,0.08412145,0.06822172,0.05230482,0.03637475,0.02043552,0.00449115,-0.01145435,-0.02739697,-0.04333269,-0.05925751,-0.0751674,-0.09105837,-0.10692642,-0.12276755,-0.13857778,-0.15435312,-0.1700896,-0.18578326,-0.20143015,-0.21702633,-0.23256788,-0.24805088,-0.26347144,-0.27882566,-0.2941097,-0.30931969,-0.32445181,-0.33950226,-0.35446724,-0.36934298,-0.38412574,-0.3988118,-0.41339746,-0.42787905,-0.44225292,-0.45651546,-0.47066308,-0.48469221,-0.49859931,-0.5123809,-0.5260335,-0.53955368,-0.55293802,-0.56618317,-0.57928578,-0.59224256,-0.60505024,-0.61770561,-0.63020547,-0.64254668,-0.65472614,-0.66674077,-0.67858755,-0.6902635,-0.70176568,-0.7130912,-0.7242372,-0.73520087,-0.74597946,-0.75657026,-0.7669706,-0.77717785,-0.78718945,-0.79700288,-0.80661567,-0.8160254,-0.8252297,-0.83422626,-0.8430128,-0.85158711,-0.85994705,-0.86809049,-0.8760154,-0.88371978,-0.89120169,-0.89845924,-0.90549061,-0.91229402,-0.91886777,-0.9252102,-0.93131972,-0.93719478,-0.9428339,-0.94823567,-0.95339873,-0.95832178,-0.96300357,-0.96744294,-0.97163875,-0.97558996,-0.97929557,-0.98275464,-0.98596632,-0.98892978,-0.99164428,-0.99410915,-0.99632375,-0.99828753,-1" label="" r="1" stroke="black" stroke-width="2" fill="black" fill-opacity="1" stroke-opacity="1" />
	<point z-index="0" layer="" x="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0" y="1,0.99828753,0.99632375,0.99410915,0.99164428,0.98892978,0.98596632,0.98275464,0.97929557,0.97558996,0.97163875,0.96744294,0.96300357,0.95832178,0.95339873,0.94823567,0.9428339,0.93719478,0.93131972,0.9252102,0.91886777,0.91229402,0.90549061,0.89845924,0.89120169,0.88371978,0.8760154,0.86809049,0.85994705,0.85158711,0.8430128,0.83422626,0.8252297,0.8160254,0.80661567,0.79700288,0.78718945,0.77717785,0.7669706,0.75657026,0.74597946,0.73520087,0.7242372,0.7130912,0.70176568,0.6902635,0.67858755,0.66674077,0.65472614,0.64254668,0.63020547,0.61770561,0.60505024,0.59224256,0.57928578,0.56618317,0.55293802,0.53955368,0.5260335,0.5123809,0.49859931,0.48469221,0.47066308,0.45651546,0.44225292,0.42787905,0.41339746,0.3988118,0.38412574,0.36934298,0.35446724,0.33950226,0.32445181,0.30931969,0.2941097,0.27882566,0.26347144,0.24805088,0.23256788,0.21702633,0.20143015,0.18578326,0.1700896,0.15435312,0.13857778,0.12276755,0.10692642,0.09105837,0.0751674,0.05925751,0.04333269,0.02739697,0.01145435,-0.00449115,-0.02043552,-0.03637475,-0.05230482,-0.06822172,-0.08412145,-0.1" z="-0.1,-0.11585338,-0.13167759,-0.14746865,-0.16322259,-0.17893543,-0.19460324,-0.21022205,-0.22578793,-0.24129698,-0.25674528,-0.27212895,-0.28744411,-0.30268691,-0.31785351,-0.33294009,-0.34794286,-0.36285803,-0.37768185,-0.3924106,-0.40704056,-0.42156805,-0.43598941,-0.45030101,-0.46449925,-0.47858056,-0.49254138,-0.50637821,-0.52008757,-0.53366599,-0.54711007,-0.56041641,-0.57358167,-0.58660254,-0.59947573,-0.61219801,-0.62476617,-0.63717705,-0.64942752,-0.6615145,-0.67343495,-0.68518587,-0.6967643,-0.70816731,-0.71939205,-0.73043569,-0.74129545,-0.75196858,-0.76245242,-0.7727443,-0.78284166,-0.79274194,-0.80244265,-0.81194135,-0.82123565,-0.8303232,-0.83920173,-0.84786899,-0.85632281,-0.86456105,-0.87258164,-0.88038257,-0.88796186,-0.89531761,-0.90244798,-0.90935115,-0.9160254,-0.92246905,-0.92868047,-0.9346581,-0.94040044,-0.94590603,-0.9511735,-0.95620151,-0.96098881,-0.96553418,-0.96983648,-0.97389464,-0.97770762,-0.98127446,-0.98459428,-0.98766623,-0.99048954,-0.9930635,-0.99538746,-0.99746084,-0.99928311,-1.00085382,-1.00217257,-1.00323903,-1.00405293,-1.00461406,-1.00492228,-1.00497753,-1.00477977,-1.00432907,-1.00362553,-1.00266934,-1.00146072,-1" label="" r="1" stroke="black" stroke-width="2" fill="black" fill-opacity="1" stroke-opacity="1" />
	<point z-index="0" layer="" x="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0" y="0,-0.0015866,-0.00317279,-0.00475819,-0.00634239,-0.007925,-0.0095056,-0.01108382,-0.01265925,-0.01423148,-0.01580014,-0.01736482,-0.01892512,-0.02048067,-0.02203105,-0.02357589,-0.0251148,-0.02664738,-0.02817326,-0.02969204,-0.03120334,-0.0327068,-0.03420201,-0.03568862,-0.03716625,-0.03863451,-0.04009305,-0.0415415,-0.04297949,-0.04440666,-0.04582265,-0.04722711,-0.04861967,-0.05,-0.05136774,-0.05272255,-0.05406408,-0.05539201,-0.05670599,-0.05800569,-0.05929079,-0.06056097,-0.0618159,-0.06305527,-0.06427876,-0.06548607,-0.0666769,-0.06785094,-0.0690079,-0.07014749,-0.07126942,-0.0723734,-0.07345917,-0.07452644,-0.07557496,-0.07660444,-0.07761465,-0.07860531,-0.07957618,-0.08052703,-0.0814576,-0.08236766,-0.08325699,-0.08412535,-0.08497254,-0.08579834,-0.08660254,-0.08738494,-0.08814534,-0.08888354,-0.08959938,-0.09029265,-0.0909632,-0.09161085,-0.09223543,-0.09283679,-0.09341479,-0.09396926,-0.09450008,-0.09500711,-0.09549022,-0.0959493,-0.09638422,-0.09679487,-0.09718116,-0.09754298,-0.09788024,-0.09819287,-0.09848078,-0.09874389,-0.09898214,-0.09919548,-0.09938385,-0.09954719,-0.09968548,-0.09979867,-0.09988673,-0.09994965,-0.09998741,-0.1" z="-0.1,-0.09998741,-0.09994965,-0.09988673,-0.09979867,-0.09968548,-0.09954719,-0.09938385,-0.09919548,-0.09898214,-0.09874389,-0.09848078,-0.09819287,-0.09788024,-0.09754298,-0.09718116,-0.09679487,-0.09638422,-0.0959493,-0.09549022,-0.09500711,-0.09450008,-0.09396926,-0.09341479,-0.09283679,-0.09223543,-0.09161085,-0.0909632,-0.09029265,-0.08959938,-0.08888354,-0.08814534,-0.08738494,-0.08660254,-0.08579834,-0.08497254,-0.08412535,-0.08325699,-0.08236766,-0.0814576,-0.08052703,-0.07957618,-0.07860531,-0.07761465,-0.07660444,-0.07557496,-0.07452644,-0.07345917,-0.0723734,-0.07126942,-0.07014749,-0.0690079,-0.06785094,-0.0666769,-0.06548607,-0.06427876,-0.06305527,-0.0618159,-0.06056097,-0.05929079,-0.05800569,-0.05670599,-0.05539201,-0.05406408,-0.05272255,-0.05136774,-0.05,-0.04861967,-0.04722711,-0.04582265,-0.04440666,-0.04297949,-0.0415415,-0.04009305,-0.03863451,-0.03716625,-0.03568862,-0.03420201,-0.0327068,-0.03120334,-0.02969204,-0.02817326,-0.02664738,-0.0251148,-0.02357589,-0.02203105,-0.02048067,-0.01892512,-0.01736482,-0.01580014,-0.01423148,-0.01265925,-0.01108382,-0.0095056,-0.007925,-0.00634239,-0.00475819,-0.00317279,-0.0015866,0" label="" r="1" stroke="black" stroke-width="2" fill="black" fill-opacity="1" stroke-opacity="1" />
	<point z-index="0" layer="" x="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0" y="1,1.00146072,1.00266934,1.00362553,1.00432907,1.00477977,1.00497753,1.00492228,1.00461406,1.00405293,1.00323903,1.00217257,1.00085382,0.99928311,0.99746084,0.99538746,0.9930635,0.99048954,0.98766623,0.98459428,0.98127446,0.97770762,0.97389464,0.96983648,0.96553418,0.96098881,0.95620151,0.9511735,0.94590603,0.94040044,0.9346581,0.92868047,0.92246905,0.9160254,0.90935115,0.90244798,0.89531761,0.88796186,0.88038257,0.87258164,0.86456105,0.85632281,0.84786899,0.83920173,0.8303232,0.82123565,0.81194135,0.80244265,0.79274194,0.78284166,0.7727443,0.76245242,0.75196858,0.74129545,0.73043569,0.71939205,0.70816731,0.6967643,0.68518587,0.67343495,0.6615145,0.64942752,0.63717705,0.62476617,0.61219801,0.59947573,0.58660254,0.57358167,0.56041641,0.54711007,0.53366599,0.52008757,0.50637821,0.49254138,0.47858056,0.46449925,0.45030101,0.43598941,0.42156805,0.40704056,0.3924106,0.37768185,0.36285803,0.34794286,0.33294009,0.31785351,0.30268691,0.28744411,0.27212895,0.25674528,0.24129698,0.22578793,0.21022205,0.19460324,0.17893543,0.16322259,0.14746865,0.13167759,0.11585338,0.1" z="0.1,0.08412145,0.06822172,0.05230482,0.03637475,0.02043552,0.00449115,-0.01145435,-0.02739697,-0.04333269,-0.05925751,-0.0751674,-0.09105837,-0.10692642,-0.12276755,-0.13857778,-0.15435312,-0.1700896,-0.18578326,-0.20143015,-0.21702633,-0.23256788,-0.24805088,-0.26347144,-0.27882566,-0.2941097,-0.30931969,-0.32445181,-0.33950226,-0.35446724,-0.36934298,-0.38412574,-0.3988118,-0.41339746,-0.42787905,-0.44225292,-0.45651546,-0.47066308,-0.48469221,-0.49859931,-0.5123809,-0.5260335,-0.53955368,-0.55293802,-0.56618317,-0.57928578,-0.59224256,-0.60505024,-0.61770561,-0.63020547,-0.64254668,-0.65472614,-0.66674077,-0.67858755,-0.6902635,-0.70176568,-0.7130912,-0.7242372,-0.73520087,-0.74597946,-0.75657026,-0.7669706,-0.77717785,-0.78718945,-0.79700288,-0.80661567,-0.8160254,-0.8252297,-0.83422626,-0.8430128,-0.85158711,-0.85994705,-0.86809049,-0.8760154,-0.88371978,-0.89120169,-0.89845924,-0.90549061,-0.91229402,-0.91886777,-0.9252102,-0.93131972,-0.93719478,-0.9428339,-0.94823567,-0.95339873,-0.95832178,-0.96300357,-0.96744294,-0.97163875,-0.97558996,-0.97929557,-0.98275464,-0.98596632,-0.98892978,-0.99164428,-0.99410915,-0.99632375,-0.99828753,-1" label="" r="1" stroke="black" stroke-width="2" fill="black" fill-opacity="1" stroke-opacity="1" />
	<point z-index="0" layer="" x="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0" y="1,0.99828753,0.99632375,0.99410915,0.99164428,0.98892978,0.98596632,0.98275464,0.97929557,0.97558996,0.97163875,0.96744294,0.96300357,0.95832178,0.95339873,0.94823567,0.9428339,0.93719478,0.93131972,0.9252102,0.91886777,0.91229402,0.90549061,0.89845924,0.89120169,0.88371978,0.8760154,0.86809049,0.85994705,0.85158711,0.8430128,0.83422626,0.8252297,0.8160254,0.80661567,0.79700288,0.78718945,0.77717785,0.7669706,0.75657026,0.74597946,0.73520087,0.7242372,0.7130912,0.70176568,0.6902635,0.67858755,0.66674077,0.65472614,0.64254668,0.63020547,0.61770561,0.60505024,0.59224256,0.57928578,0.56618317,0.55293802,0.53955368,0.5260335,0.5123809,0.49859931,0.48469221,0.47066308,0.45651546,0.44225292,0.42787905,0.41339746,0.3988118,0.38412574,0.36934298,0.35446724,0.33950226,0.32445181,0.30931969,0.2941097,0.27882566,0.26347144,0.24805088,0.23256788,0.21702633,0.20143015,0.18578326,0.1700896,0.15435312,0.13857778,0.12276755,0.10692642,0.09105837,0.0751674,0.05925751,0.04333269,0.02739697,0.01145435,-0.00449115,-0.02043552,-0.03637475,-0.05230482,-0.06822172,-0.08412145,-0.1" z="-0.1,-0.11585338,-0.13167759,-0.14746865,-0.16322259,-0.17893543,-0.19460324,-0.21022205,-0.22578793,-0.24129698,-0.25674528,-0.27212895,-0.28744411,-0.30268691,-0.31785351,-0.33294009,-0.34794286,-0.36285803,-0.37768185,-0.3924106,-0.40704056,-0.42156805,-0.43598941,-0.45030101,-0.46449925,-0.47858056,-0.49254138,-0.50637821,-0.52008757,-0.53366599,-0.54711007,-0.56041641,-0.57358167,-0.58660254,-0.59947573,-0.61219801,-0.62476617,-0.63717705,-0.64942752,-0.6615145,-0.67343495,-0.68518587,-0.6967643,-0.70816731,-0.71939205,-0.73043569,-0.74129545,-0.75196858,-0.76245242,-0.7727443,-0.78284166,-0.79274194,-0.80244265,-0.81194135,-0.82123565,-0.8303232,-0.83920173,-0.84786899,-0.85632281,-0.86456105,-0.87258164,-0.88038257,-0.88796186,-0.89531761,-0.90244798,-0.90935115,-0.9160254,-0.92246905,-0.92868047,-0.9346581,-0.94040044,-0.94590603,-0.9511735,-0.95620151,-0.96098881,-0.96553418,-0.96983648,-0.97389464,-0.97770762,-0.98127446,-0.98459428,-0.98766623,-0.99048954,-0.9930635,-0.99538746,-0.99746084,-0.99928311,-1.00085382,-1.00217257,-1.00323903,-1.00405293,-1.00461406,-1.00492228,-1.00497753,-1.00477977,-1.00432907,-1.00362553,-1.00266934,-1.00146072,-1" label="" r="1" stroke="black" stroke-width="2" fill="black" fill-opacity="1" stroke-opacity="1" />
	<point z-index="0" layer="" x="1,1.00012586,1.00050333,1.00113202,1.00201129,1.00314027,1.0045178,1.00614249,1.00801269,1.01012649,1.01248173,1.01507597,1.01790655,1.02097053,1.0242647,1.02778562,1.03152956,1.03549255,1.03967034,1.04405845,1.04865211,1.05344631,1.05843576,1.06361492,1.06897801,1.07451896,1.08023148,1.08610902,1.09214476,1.09833166,1.10466243,1.11112955,1.11772526,1.12444159,1.13127034,1.13820311,1.14523127,1.15234604,1.15953843,1.16679928,1.17411927,1.18148892,1.18889864,1.19633868,1.20379921,1.21127029,1.2187419,1.22620397,1.23364638,1.24105898,1.24843161,1.25575412,1.2630164,1.27020837,1.27732004,1.2843415,1.29126295,1.29807472,1.30476729,1.31133133,1.31775767,1.32403739,1.33016178,1.33612238,1.34191103,1.34751982,1.35294118,1.35816784,1.36319291,1.36800981,1.37261235,1.37699473,1.38115154,1.38507777,1.38876883,1.39222055,1.3954292,1.39839146,1.40110448,1.40356584,1.40577355,1.40772608,1.40942234,1.41086166,1.41204383,1.41296905,1.41363794,1.41405156,1.41421134,1.41411913,1.41377716,1.41318801,1.41235465,1.41128038,1.40996882,1.40842392,1.40664992,1.40465137,1.40243304,1.4" y="2,1.99803579,1.99531696,1.99184447,1.98761967,1.9826443,1.97692048,1.97045073,1.96323795,1.95528543,1.9465969,1.93717647,1.92702867,1.91615846,1.90457123,1.89227282,1.8792695,1.86556802,1.85117557,1.83609983,1.82034897,1.80393165,1.78685704,1.76913481,1.75077516,1.73178882,1.71218706,1.69198171,1.67118513,1.64981025,1.62787056,1.60538014,1.58235362,1.55880621,1.53475371,1.51021247,1.48519943,1.4597321,1.43382855,1.4075074,1.38078782,1.35368954,1.32623278,1.29843828,1.27032729,1.2419215,1.21324308,1.18431462,1.15515911,1.1257999,1.09626072,1.06656559,1.0367388,1.00680491,0.97678868,0.94671501,0.91660896,0.88649566,0.85640028,0.82634799,0.7963639,0.76647302,0.73670024,0.70707024,0.67760746,0.64833604,0.61927981,0.5904622,0.56190622,0.53363439,0.50566872,0.47803064,0.450741,0.42381999,0.3972871,0.37116111,0.34546006,0.32020118,0.29540089,0.27107475,0.24723749,0.22390291,0.20108392,0.1787925,0.15703971,0.13583565,0.11518947,0.09510936,0.07560257,0.05667537,0.03833311,0.02058018,0.00342005,-0.01314475,-0.02911255,-0.04448262,-0.05925504,-0.07343076,-0.08701156,-0.1" z="-0.1,-0.13171734,-0.16338954,-0.19499664,-0.22651869,-0.25793574,-0.28922789,-0.32037522,-0.35135785,-0.38215593,-0.41274962,-0.44311914,-0.47324472,-0.50310666,-0.53268529,-0.56196103,-0.59091432,-0.61952574,-0.6477759,-0.67564555,-0.70311553,-0.73016683,-0.75678055,-0.78293798,-0.80862056,-0.83380993,-0.85848796,-0.88263672,-0.90623858,-0.92927615,-0.95173237,-0.97359048,-0.99483411,-1.01544724,-1.03541428,-1.05472008,-1.07334994,-1.09128969,-1.10852565,-1.12504474,-1.14083445,-1.15588289,-1.17017885,-1.18371179,-1.19647189,-1.20845007,-1.21963805,-1.23002834,-1.23961429,-1.24839012,-1.25635093,-1.26349274,-1.26981249,-1.2753081,-1.27997845,-1.2838234,-1.28684382,-1.28904161,-1.29041969,-1.29098199,-1.29073349,-1.2896802,-1.28782917,-1.28518846,-1.28176715,-1.27757534,-1.2726241,-1.26692547,-1.26049246,-1.25333898,-1.24547986,-1.23693077,-1.22770824,-1.2178296,-1.20731291,-1.19617699,-1.1844413,-1.17212596,-1.15925166,-1.14583965,-1.13191165,-1.11748982,-1.10259673,-1.08725526,-1.0714886,-1.05532014,-1.03877349,-1.02187235,-1.00464053,-0.98710184,-0.96928008,-0.95119897,-0.93288211,-0.91435295,-0.89563469,-0.87675033,-0.85772252,-0.83857362,-0.81932559,-0.8" label="" r="1" stroke="black" stroke-width="2" fill="black" fill-opacity="1" stroke-opacity="1" />
	<point z-index="0" layer="" x="1,1.00012586,1.00050333,1.00113202,1.00201129,1.00314027,1.0045178,1.00614249,1.00801269,1.01012649,1.01248173,1.01507597,1.01790655,1.02097053,1.0242647,1.02778562,1.03152956,1.03549255,1.03967034,1.04405845,1.04865211,1.05344631,1.05843576,1.06361492,1.06897801,1.07451896,1.08023148,1.08610902,1.09214476,1.09833166,1.10466243,1.11112955,1.11772526,1.12444159,1.13127034,1.13820311,1.14523127,1.15234604,1.15953843,1.16679928,1.17411927,1.18148892,1.18889864,1.19633868,1.20379921,1.21127029,1.2187419,1.22620397,1.23364638,1.24105898,1.24843161,1.25575412,1.2630164,1.27020837,1.27732004,1.2843415,1.29126295,1.29807472,1.30476729,1.31133133,1.31775767,1.32403739,1.33016178,1.33612238,1.34191103,1.34751982,1.35294118,1.35816784,1.36319291,1.36800981,1.37261235,1.37699473,1.38115154,1.38507777,1.38876883,1.39222055,1.3954292,1.39839146,1.40110448,1.40356584,1.40577355,1.40772608,1.40942234,1.41086166,1.41204383,1.41296905,1.41363794,1.41405156,1.41421134,1.41411913,1.41377716,1.41318801,1.41235465,1.41128038,1.40996882,1.40842392,1.40664992,1.40465137,1.40243304,1.4" y="2,2.00120899,2.00166255,2.00136085,2.00030445,1.99849429,1.99593169,1.99261837,1.98855644,1.9837484,1.97819718,1.9719061,1.96487891,1.95711979,1.94863334,1.93942461,1.9294991,1.91886278,1.90752208,1.8954839,1.88275566,1.86934525,1.85526107,1.84051205,1.82510765,1.80905784,1.79237317,1.77506471,1.75714411,1.73862357,1.71951587,1.69983435,1.67959297,1.65880621,1.63748918,1.61565756,1.59332759,1.57051611,1.54724052,1.52351878,1.49936941,1.47481148,1.44986458,1.42454882,1.39888481,1.37289365,1.34659688,1.3200165,1.29317491,1.26609488,1.23879956,1.21131239,1.18365714,1.1558578,1.12793859,1.0999239,1.07183825,1.04370628,1.01555265,0.98740204,0.95927909,0.93120834,0.90321422,0.87532095,0.84755254,0.81993272,0.79248489,0.76523208,0.73819689,0.71140148,0.68486747,0.65861595,0.6326674,0.60704168,0.58175795,0.5568347,0.53228964,0.50813971,0.48440105,0.46108898,0.43821794,0.4158015,0.39385235,0.37238224,0.35140203,0.33092161,0.31094996,0.2914951,0.27256412,0.25416315,0.2362974,0.21897115,0.20218774,0.18594964,0.1702584,0.15511472,0.14051843,0.12646855,0.11296326,0.1" z="0.1,0.06825748,0.03650976,0.00477683,-0.02692135,-0.05856479,-0.0901335,-0.12160752,-0.15296689,-0.18419164,-0.21526184,-0.24615759,-0.27685898,-0.30734617,-0.33759934,-0.36759871,-0.39732458,-0.42675731,-0.45587731,-0.4846651,-0.51310131,-0.54116667,-0.56884203,-0.59610841,-0.62294697,-0.64933907,-0.67526626,-0.70071032,-0.72565327,-0.7500774,-0.77396528,-0.79729981,-0.82006423,-0.84224216,-0.8638176,-0.88477499,-0.90509924,-0.92477572,-0.94379034,-0.96212955,-0.9797804,-0.99673053,-1.01296824,-1.0284825,-1.043263,-1.05730015,-1.07058516,-1.08310999,-1.09486748,-1.10585128,-1.11605595,-1.12547694,-1.13411061,-1.1419543,-1.1490063,-1.15526587,-1.16073329,-1.16540982,-1.16929775,-1.1724004,-1.17472211,-1.17626823,-1.17704516,-1.1770603,-1.17632206,-1.17483986,-1.1726241,-1.16968613,-1.16603824,-1.16169368,-1.15666653,-1.15097179,-1.14462524,-1.13764349,-1.13004389,-1.12184449,-1.11306405,-1.10372193,-1.09383807,-1.08343296,-1.07252757,-1.06114331,-1.04930197,-1.03702566,-1.02433681,-1.01125803,-0.99781215,-0.9840221,-0.96991089,-0.95550156,-0.94081711,-0.92588048,-0.91071447,-0.89534174,-0.8797847,-0.86406554,-0.84820614,-0.83222803,-0.8161524,-0.8" label="" r="1" stroke="black" stroke-width="2" fill="black" fill-opacity="1" stroke-opacity="1" />
	<point z-index="0" layer="" x="1.5,1.50006293,1.50025167,1.50056601,1.50100565,1.50157014,1.5022589,1.50307125,1.50400635,1.50506325,1.50624086,1.50753799,1.50895328,1.51048526,1.51213235,1.51389281,1.51576478,1.51774627,1.51983517,1.52202923,1.52432606,1.52672315,1.52921788,1.53180746,1.534489,1.53725948,1.54011574,1.54305451,1.54607238,1.54916583,1.55233121,1.55556477,1.55886263,1.5622208,1.56563517,1.56910155,1.57261564,1.57617302,1.57976922,1.58339964,1.58705963,1.59074446,1.59444932,1.59816934,1.6018996,1.60563514,1.60937095,1.61310199,1.61682319,1.62052949,1.6242158,1.62787706,1.6315082,1.63510418,1.63866002,1.64217075,1.64563148,1.64903736,1.65238365,1.65566566,1.65887884,1.6620187,1.66508089,1.66806119,1.67095551,1.67375991,1.67647059,1.67908392,1.68159645,1.6840049,1.68630617,1.68849737,1.69057577,1.69253888,1.69438441,1.69611027,1.6977146,1.69919573,1.70055224,1.70178292,1.70288678,1.70386304,1.70471117,1.70543083,1.70602191,1.70648452,1.70681897,1.70702578,1.70710567,1.70705957,1.70688858,1.70659401,1.70617733,1.70564019,1.70498441,1.70421196,1.70332496,1.70232568,1.70121652,1.7" y="1.5,1.4998112,1.49924488,1.49830133,1.49698103,1.49528465,1.49321304,1.49076728,1.4879486,1.48475846,1.48119852,1.47727064,1.4729769,1.46831956,1.46330114,1.45792436,1.45219215,1.4461077,1.43967441,1.43289593,1.42577616,1.41831922,1.41052953,1.40241171,1.3939707,1.38521167,1.37614006,1.36676161,1.35708231,1.34710845,1.33684661,1.32630362,1.31548665,1.30440311,1.29306072,1.28146751,1.26963175,1.25756205,1.24526727,1.23275654,1.22003931,1.20712525,1.19402434,1.18074677,1.16730302,1.15370379,1.13995999,1.12608278,1.1120835,1.0979737,1.08376507,1.0694695,1.05509899,1.04066568,1.02618182,1.01165973,0.9971118,0.98255049,0.96798823,0.95343751,0.93891075,0.92442034,0.90997862,0.8955978,0.88129,0.86706719,0.85294118,0.83892357,0.82502578,0.81125897,0.79763405,0.78416165,0.7708521,0.75771542,0.74476126,0.73199895,0.71943742,0.70708522,0.69495048,0.68304093,0.67136386,0.6599261,0.64873407,0.63779369,0.62711044,0.61668932,0.60653486,0.59665112,0.58704167,0.57770963,0.56865763,0.55988783,0.55140195,0.54320122,0.53528646,0.52765803,0.52031585,0.51325945,0.50648793,0.5" z="0,-0.01586497,-0.03171994,-0.04755495,-0.06336001,-0.07912513,-0.09484035,-0.11049568,-0.12608118,-0.14158689,-0.15700287,-0.17231918,-0.18752593,-0.20261321,-0.21757116,-0.23238993,-0.24705973,-0.26157076,-0.2759133,-0.29007766,-0.30405421,-0.31783337,-0.33140565,-0.3447616,-0.35789188,-0.37078725,-0.38343855,-0.39583676,-0.40797296,-0.41983839,-0.43142441,-0.44272257,-0.45372458,-0.46442235,-0.47480797,-0.48487377,-0.4946123,-0.50401635,-0.513079,-0.52179357,-0.53015371,-0.53815336,-0.54578677,-0.55304857,-0.55993372,-0.56643756,-0.5725558,-0.57828458,-0.58362044,-0.58856035,-0.59310172,-0.59724242,-0.60098078,-0.6043156,-0.60724619,-0.60977232,-0.61189428,-0.61361286,-0.61492936,-0.6158456,-0.6163639,-0.61648711,-0.61621858,-0.61556219,-0.6145223,-0.6131038,-0.61131205,-0.6091529,-0.60663268,-0.60375816,-0.6005366,-0.59697564,-0.59308337,-0.58886827,-0.5843392,-0.57950537,-0.57437634,-0.56896197,-0.56327243,-0.55731815,-0.5511098,-0.54465828,-0.53797467,-0.53107023,-0.52395635,-0.51664454,-0.50914641,-0.50147361,-0.49363785,-0.48565085,-0.4775243,-0.46926986,-0.46089915,-0.45242367,-0.44385485,-0.43520397,-0.42648217,-0.41770041,-0.4088695,-0.4" label="" r="1" stroke="black" stroke-width="2" fill="black" fill-opacity="1" stroke-opacity="1" />
	<pathC z-index="0" layer="" label="" stroke="black" stroke-width="1" stroke-opacity="1" fill="none" fill-opacity="1" d="5,6,7,8,5" />
	<pathC z-index="0" layer="" label="" stroke="black" stroke-width="1" stroke-opacity="1" fill="none" fill-opacity="1" d="9,10,11,12,9" />
</svg_doc>

<body style="margin:0px;background-color:;overflow:hidden;" >
	<a id='keydown' type='checkbox' onkeydown="javascript:;" ></a>
	<div style="font-family:Bookman Old Style;font-size:12px;margin:0px;background-color:;overflow:hidden;position:fixed;width:170px;top:20px;right:20px;" id='control_panel' >
		<div id='control_panel_layers' style="width:200px;" ></div>
	</div>
	<svg id="world" style="background-color:;width:100%;height:100%;position:absolute;top:0;left:0;z-index:-1;" onload="Javascript:onLoadFunctions();" xmlns="http://www.w3.org/2000/svg" version="1.1"></svg>
</body>

<script type="text/javascript" >
	var svgDocument = document.getElementById("world");
</script>

<script type="text/javascript" >

	// Parameters set by user
	var animation_duration = 3;
	var animation_reverse = 1;
	var animation_repeat = -1;
	var animation_count = 0;

	function add(a, b){
		s = new Array(a.length);
		for (var i = 0, len = a.length; i < len; i++) s[i] = a[i] + b[i];
		return s;
	}
	
	function dist(a, b){
		var i;
		var s = 0;
		for(i = 0;i < a.length;i++) s += Math.pow(b[i] - a[i], 2)
		return Math.sqrt(s);
	}
	
	function addC(a, b){
		s = new Array(a.length);
		for (var i = 0, len = a.length; i < len; i++) s[i] = a[i] + b;
		return s;
	}
	
	function inv(a){
		s = new Array(a.length);
		for (var i = 0, len = a.length; i < len; i++) s[i] = 1 / a[i];
		return s;
	}
	
	function multC(a, b){
		s = new Array(a.length);
		for (var i = 0, len = a.length; i < len; i++) s[i] = a[i] * b;
		return s;
	}
	
	function rotateTrig(r){return {sin : -Math.sin(r), cos : Math.cos(r)};}
	
	function rotateVector(v, deg){
		var rad = degToRad(deg);
		var vec = new Array(v[0]*Math.cos(rad) - v[1]*Math.sin(rad), v[0]*Math.sin(rad) + v[1]*Math.cos(rad));
		return vec;
	}
	
	function rotateX1(a, t) {
		var tmp = a.y;
		a.y = (t.cos * a.y) - (t.sin * a.z);
		a.z = (t.sin * tmp) + (t.cos * a.z);
		return a;
	}
	
	function rotateY1(a, t) {
		var tmp = a.x;
		a.x = (t.cos * a.x) + (t.sin * a.z);
		a.z = - (t.sin * tmp) + (t.cos * a.z);
		return a;
	}
	
	function rotateZ1(a, t) {
		var tmp = a.x;
		a.x = (t.cos * a.x) - (t.sin * a.y);
		a.y = (t.sin * tmp) + (t.cos * a.y);
		return a;
	}
	
	function rotateX2(a, t) {
		var tmp = a.y;
		a.y = sub(multC(a.y, t.cos), multC(a.z, t.sin));
		a.z = add(multC(tmp, t.sin), multC(a.z, t.cos));
		return a;
	}
	
	function rotateY2(a, t) {
		var tmp = a.x;
		a.x = add(multC(a.x, t.cos), multC(a.z, t.sin));
		a.z = sub(multC(a.z, t.cos), multC(tmp, t.sin));
		return a;
	}
	
	function rotateZ2(a, t) {
		var tmp = a.x;
		a.x = sub(multC(a.x, t.cos), multC(a.y, t.sin));
		a.y = add(multC(tmp, t.sin), multC(a.y, t.cos));
		return a;
	}
	
	function sub(a, b){
		s = new Array(a.length);
		for (var i = 0, len = a.length; i < len; i++) s[i] = a[i] - b[i];
		return s;
	}
	
	function uvector(v){
		var i, r;
		var s = 0;
		for(i = 0;i < v.length;i++) s += Math.pow(v[i], 2)
		var d = Math.sqrt(s);
		if(d == 0) return v;
	
		r = new Array();
		for(i = 0;i < v.length;i++) r[i] = v[i]/d
		return r;
	}
</script>
<script type="text/javascript" >
	
	function_name = new Array();
	url_path = new Array();
	innerHTML_id = new Array();
	request_status = new Array();
	xmlHttp = new Array();
	time1 = new Array();
	time2 = new Array();
	var req_ct = 0;
	var skip_buffer = 10;
	var skip_to = 0;
	var ajax_output;
	var auto_view_r_result = 0;
	
	String.prototype.firstToUpperCase = function() {
		return this.charAt(0).toUpperCase() + this.slice(1);
	}
	
	Array.prototype.firstToUpperCase = function() {
		for (var i = 0, len = this.length; i < len; i++) this[i] = this[i].firstToUpperCase();
		return this;
	}
	
	function ajax_alert_return(j, xmlHttp_object){
		alert(xmlHttp_object[j].responseText);
	}
	
	function ajax_fill_element(j, xmlHttp_object){
		document.getElementById(innerHTML_id[j]).innerHTML = xmlHttp_object[j].responseText;
		window.status= '';
	}
	
	function ajax_fill_element_return_call(j, xmlHttp_object){
		document.getElementById(innerHTML_id[j]).innerHTML = xmlHttp_object[j].responseText;
		on_ajax_request_return();
	}
	
	function ajax_fill_element_return_call2(j, xmlHttp_object){
		document.getElementById(innerHTML_id[j]).innerHTML = xmlHttp_object[j].responseText;
		on_ajax_request_return2(url_path[j]);
	}
	
	function ajax_get_xml_http_object(){
		var xmlHttp=null;
		try{ // Firefox, Opera 8.0+, Safari
			xmlHttp = new XMLHttpRequest();}
		catch(e){ // Internet Explorer		
			try{
				xmlHttp = new ActiveXObject("Msxml2.XMLHTTP");}
			catch(e){
				xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");}
		}
		return xmlHttp;
	}
	
	function ajax_request(url, send_content, call_function, element_id){
		url_path[req_ct] = url;
		function_name[req_ct] = call_function;
		innerHTML_id[req_ct] = element_id;
		request_status[req_ct] = 0;
	
		xmlHttp[req_ct]=ajax_get_xml_http_object();
		if(xmlHttp[req_ct]==null){
			alert ("Browser does not support HTTP Request");
			return;}
		xmlHttp[req_ct].onreadystatechange=ajax_state_changed;
		xmlHttp[req_ct].open("POST", url, true);
		xmlHttp[req_ct].setRequestHeader("Content-type","application/x-www-form-urlencoded");
		xmlHttp[req_ct].send(send_content);	
		window.status= 'Command to ' + url + ' sent.';
	
		time1[req_ct] = new Date().getTime() / 1000;
	
		req_ct++;
	}
	
	function ajax_state_changed(){
		var j;
		for(j = skip_to;j < xmlHttp.length; j++){
			if(request_status[j] == 1){continue;}
			if(xmlHttp[j].readyState==4 || xmlHttp[j].readyState=="complete"){
				//alert(skip_to + ' -- ' + j);
				eval(function_name[j] + '(j, xmlHttp)');
	
				time2[j] = new Date().getTime() / 1000;
				if(document.getElementById("run_time")) document.getElementById("run_time").innerHTML = "Run-time: " + Math.round((time2[j] - time1[j])*100)/100 + " sec";
				
				request_status[j] = 1;
				if(j - skip_buffer > 0){skip_to = j - skip_buffer;}
			}	
		}
	}
	
	function array_unique(arr) {
		var hash = {}, result = [];
		for(var i = 0, l = arr.length;i < l;++i){
	    	if(hash[ arr[i] ] === true) continue;
			hash[ arr[i] ] = true;
			result.push(arr[i]);    	
	    }
	    return result;
	}
	
	function array_unique_properties(arr, property) {
		var hash = {}, result = [];
		for(var i = 0, l = arr.length;i < l;++i){
	    	if(hash[ arr[i][property] ] === true) continue;
			hash[ arr[i][property] ] = true;
			result.push(arr[i][property]);    	
	    }
	    return result;
	}
	
	function baseName(ev) {
		var id = ev.target.getAttribute("id");
		return id;
	}
	
	var BrowserDetect = {
		//Source: http://www.quirksmode.org/js/detect.html
	
		init: function () {
			this.browser = this.searchString(this.dataBrowser) || "An unknown browser";
			this.version = this.searchVersion(navigator.userAgent)
				|| this.searchVersion(navigator.appVersion)
				|| "an unknown version";
			this.OS = this.searchString(this.dataOS) || "an unknown OS";
		},
		searchString: function (data) {
			for (var i=0;i<data.length;i++)	{
				var dataString = data[i].string;
				var dataProp = data[i].prop;
				this.versionSearchString = data[i].versionSearch || data[i].identity;
				if (dataString) {
					if (dataString.indexOf(data[i].subString) != -1)
						return data[i].identity;
				}
				else if (dataProp)
					return data[i].identity;
			}
		},
		searchVersion: function (dataString) {
			var index = dataString.indexOf(this.versionSearchString);
			if (index == -1) return;
			return parseFloat(dataString.substring(index+this.versionSearchString.length+1));
		},
		dataBrowser: [
			{
				string: navigator.userAgent,
				subString: "Chrome",
				identity: "Chrome"
			},
			{ 	string: navigator.userAgent,
				subString: "OmniWeb",
				versionSearch: "OmniWeb/",
				identity: "OmniWeb"
			},
			{
				string: navigator.vendor,
				subString: "Apple",
				identity: "Safari",
				versionSearch: "Version"
			},
			{
				prop: window.opera,
				identity: "Opera",
				versionSearch: "Version"
			},
			{
				string: navigator.vendor,
				subString: "iCab",
				identity: "iCab"
			},
			{
				string: navigator.vendor,
				subString: "KDE",
				identity: "Konqueror"
			},
			{
				string: navigator.userAgent,
				subString: "Firefox",
				identity: "Firefox"
			},
			{
				string: navigator.vendor,
				subString: "Camino",
				identity: "Camino"
			},
			{		// for newer Netscapes (6+)
				string: navigator.userAgent,
				subString: "Netscape",
				identity: "Netscape"
			},
			{
				string: navigator.userAgent,
				subString: "MSIE",
				identity: "Explorer",
				versionSearch: "MSIE"
			},
			{
				string: navigator.userAgent,
				subString: "Gecko",
				identity: "Mozilla",
				versionSearch: "rv"
			},
			{ 		// for older Netscapes (4-)
				string: navigator.userAgent,
				subString: "Mozilla",
				identity: "Netscape",
				versionSearch: "Mozilla"
			}
		],
		dataOS : [
			{
				string: navigator.platform,
				subString: "Win",
				identity: "Windows"
			},
			{
				string: navigator.platform,
				subString: "Mac",
				identity: "Mac"
			},
			{
				   string: navigator.userAgent,
				   subString: "iPhone",
				   identity: "iPhone/iPod"
		    },
			{
				string: navigator.platform,
				subString: "Linux",
				identity: "Linux"
			}
		]
	
	};
	
	BrowserDetect.init();
	
	function clean(array, deleteValue){
	
		if(deleteValue == undefined) var deleteValue = '';
	
		for(var i = 0; i < array.length; i++) {
			if(array[i] == deleteValue){
				array.splice(i, 1);
				i--;
				continue;
			}
			if(isNaN(deleteValue) && isNaN(array[i])){
				array.splice(i, 1);
				i--;
				continue;
			}
		}
		return array;
	}
	
	function createCookie(name, value, sec){
		if (sec) {
			var date = new Date();
			date.setTime(date.getTime()+(sec*1000));
			var expires = "; expires="+date.toGMTString();
		}
		else var expires = "";
		document.cookie = name+"="+value+expires+"; path=/";
	}
	
	function degToRad(d){
		return d*(Math.PI/180);
	}
	
	function detectKeyUp(e){
		var evt = e || window.event;
		if(evt.keyCode==82 && globalkeypress == "r"){globalkeypress = '';return;}
	}
	
	function deleteCookie(name) {
		createCookie(name,"",-1);
	}
	
	function detectKeyDown(e){
		var evt = e || window.event;
		if(evt.keyCode==82){globalkeypress = 'r';} // r
		if(evt.shiftKey === true){
			if(globalkeypress == 'r'){
				if(evt.keyCode==37){setKeyEvent("rotateYaxis", 45);} // left arrow
				if(evt.keyCode==39){setKeyEvent("rotateYaxis", -45);} // right arrow
				if(evt.keyCode==38){setKeyEvent("rotateXaxis", 45);} // up arrow
				if(evt.keyCode==40){setKeyEvent("rotateXaxis", -45);} // down arrow
				if(evt.keyCode==74){setKeyEvent("rotateZaxis", -45);} // j
				if(evt.keyCode==75){setKeyEvent("rotateZaxis", 45);} // k
			}else{
				if(evt.keyCode==37){setKeyEvent("translateX", -10);} // left arrow
				if(evt.keyCode==39){setKeyEvent("translateX", 10);} // right arrow
				if(evt.keyCode==38){setKeyEvent("translateY", 10);} // up arrow
				if(evt.keyCode==40){setKeyEvent("translateY", -10);} // down arrow
				if(evt.keyCode==74){setKeyEvent("translateZ", 10);} // j
				if(evt.keyCode==75){setKeyEvent("translateZ", -10);} // k
			}
		}else{
			if(evt.metaKey === true){
			}else{
				if(globalkeypress == 'r'){
					if(evt.keyCode==37){setKeyEvent("rotateYaxis", 10);} // left arrow
					if(evt.keyCode==39){setKeyEvent("rotateYaxis", -10);} // right arrow
					if(evt.keyCode==38){setKeyEvent("rotateXaxis", 10);} // up arrow
					if(evt.keyCode==40){setKeyEvent("rotateXaxis", -10);} // down arrow
					if(evt.keyCode==74){setKeyEvent("rotateZaxis", -10);} // j
					if(evt.keyCode==75){setKeyEvent("rotateZaxis", 10);} // k
				}else{
					if(evt.keyCode==37){setKeyEvent("translateX", -1);} // left arrow
					if(evt.keyCode==39){setKeyEvent("translateX", 1);} // right arrow
					if(evt.keyCode==38){setKeyEvent("translateY", 1);} // up arrow
					if(evt.keyCode==40){setKeyEvent("translateY", -1);} // down arrow
					if(evt.keyCode==74){setKeyEvent("translateZ", 1);} // j
					if(evt.keyCode==75){setKeyEvent("translateZ", -1);} // k
					//if(evt.keyCode==80){} // p
					if(evt.keyCode==32){setKeyEvent("playPauseAnimation");} // space-bar
				}
			}
		}
	}
	
	function doEvent(){
	
		var i, len;
		var dx = 0;
		var dy = 0;
		var dz = 0;
	
		if (currentEvent == "callZoomIn"){
			if(zoom <= 400){
				zoom = zoom + 4;
				depth = Math.floor(zoom * (eyez - maxzoom) / 100 + eyez);
			}
		}
	
		if (currentEvent == "callZoomOut"){
			if(zoom >= 175){
				zoom = zoom - 4;
				depth = Math.floor(zoom * (eyez - maxzoom) / 100 + eyez);
			}
		}
	
		if(currentEvent == "translateZ") d = -d;
	
		// Apply translation
		if (currentEvent == "translateX" || currentEvent == "translateY" || currentEvent == "translateZ")
			for (i = 0, len = shape_transform.length; i < len; i++) eval(currentEvent + '(' + shape_transform[i] + ', d)');
	
		// Apply rotation
	//	var t1 = new Date().getTime();
		if (currentEvent == "rotateXaxis" || currentEvent == "rotateYaxis" || currentEvent == "rotateZaxis")
			for (i = 0, len = shape_transform.length; i < len; i++) eval(currentEvent + '(' + shape_transform[i] + ', degToRad(d))');
	//	var t2 = new Date().getTime();
	//	alert(t2 - t1)
	
		if (currentEvent == "playPauseAnimation"){
			if(stop_anim == 1){stop_anim = 0;}else{stop_anim = 1;}
			playPauseAnimation();
		}
	}
	
	function extract_number(strString){
		var strValidChars = "0123456789.-";
		var strChar;
		var returnString = "";
		var i;
		
		if (strString.length == 0) return false;
	
		for (i = 0; i < strString.length; i++){
			strChar = strString.charAt(i);
			if(strValidChars.indexOf(strChar) > -1) returnString += strChar;
		}
		return parseFloat(returnString);
	}
	
	function extract_alpha(strString){
		var strNonAlphaChars = "0123456789.-";
		var strChar;
		var returnString = "";
		var i;
		
		if (strString.length == 0) return false;
	
		for (i = 0; i < strString.length; i++){
			strChar = strString.charAt(i);
			if(strNonAlphaChars.indexOf(strChar) == -1) returnString += strChar;
		}
		return returnString;
	}
	
	function firstToUpperCase(string){
		if(typeof string === 'string'){
			return string.charAt(0).toUpperCase() + string.slice(1);
		}else{
			var string_array = new Array();
			for (var i = 0, len = string.length; i < len; i++) string_array[i] = firstToUpperCase(string[i]);
			return string_array;
		}
	}
	
	function getCookie(Name){ 
		var re=new RegExp(Name+"=[^;]+", "i"); //construct RE to search for target name/value pair
		if (document.cookie.match(re)) //if cookie found
			return document.cookie.match(re)[0].split("=")[1] //return its value
		return false;
	}
	
	function getMouseXYLocal(e){
		if(IE){return new Array(event.clientX,event.clientY);}else{return new Array(e.pageX,e.pageY);}
	}
	
	function getStyle(el, styleProp) {
	  var value, defaultView = (el.ownerDocument || document).defaultView;
	  // W3C standard way:
	  if (defaultView && defaultView.getComputedStyle) {
	    // sanitize property name to css notation
	    // (hypen separated words eg. font-Size)
	    styleProp = styleProp.replace(/([A-Z])/g, "-$1").toLowerCase();
	    return defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);
	  } else if (el.currentStyle) { // IE
	    // sanitize property name to camelCase
	    styleProp = styleProp.replace(/\-(\w)/g, function(str, letter) {
	      return letter.toUpperCase();
	    });
	    value = el.currentStyle[styleProp];
	    // convert other units to pixels on IE
	    if (/^\d+(em|pt|%|ex)?$/i.test(value)) { 
	      return (function(value) {
	        var oldLeft = el.style.left, oldRsLeft = el.runtimeStyle.left;
	        el.runtimeStyle.left = el.currentStyle.left;
	        el.style.left = value || 0;
	        value = el.style.pixelLeft + "px";
	        el.style.left = oldLeft;
	        el.runtimeStyle.left = oldRsLeft;
	        return value;
	      })(value);
	    }
	    return value;
	  }
	}
	
	function getWindowHeight(){
		var y = 0;
		if (self.innerHeight) {
			y = self.innerHeight;
		} else if (document.documentElement && document.documentElement.clientHeight) {
			y = document.documentElement.clientHeight;
		} else if (document.body) {
			y = document.body.clientHeight;
		}
	
		return y;
	}
	
	function getWindowWidth(){
		var x = 0;
		if (self.innerHeight) {
			x = self.innerWidth;
		} else if (document.documentElement && document.documentElement.clientHeight) {
			x = document.documentElement.clientWidth;
		} else if (document.body) {
			x = document.body.clientWidth;
		}
		
		return x;
	}
	
	function has_numeric(strString){
		var strValidChars = "0123456789.-";
		var strChar;
		var blnResult = false;
		var i;
		
		if (strString.length == 0) return false;
	
		//  test strString consists of valid characters listed above
		for (i = 0; i < strString.length && blnResult == false; i++){
			strChar = strString.charAt(i);
			if (strValidChars.indexOf(strChar) > -1){
				blnResult = true;
			}
		}
		return blnResult;
	}
	
	function is_array(input){
		return typeof(input)=='object'&&(input instanceof Array);
	}
	
	function is_numeric(strString){
		var strValidChars = "0123456789.-";
		var strChar;
		var blnResult = true;
		var i;
		
		if (strString.length == 0) return false;
	
		//  test strString consists of valid characters listed above
		for (i = 0; i < strString.length && blnResult == true; i++){
			strChar = strString.charAt(i);
			if (strValidChars.indexOf(strChar) == -1){
				blnResult = false;
			}
		}
		return blnResult;
	}
	
	function mouseDownEvent(e){
	
		e.preventDefault();
	
		initialX = e.clientX;
		initialY = e.clientY;
		mousedown = 1;
	}
	
	function mouseUpEvent(e){	
	
		e.preventDefault();
	
		mousedown = 0;
	}
	
	function on_ajax_request_return2(url){
		ajax_request(url, 'function=print_ui', 'ajax_fill_element', 'ui_div');
		if(auto_view_r_result){
			document.getElementById('r_call_view').submit();
		}
		window.status= '';
	}
	
	function open_text_in_new_window(){
		window.open('A.html','A','width=300, height=200');
	}
	
	function parse_style_string(string){
	
		style_array = new Array();
		string_split1 = string.split(";");
	
		for(i in string_split1){
			if(string_split1[i] == "") continue;
			string_split2 = string_split1[i].split(":");
			style_array[string_split2[0]] = string_split2[1];
		}
	
		return style_array; 
	}
	
	function pixel_to_font_size(pixel_height){
		return pixel_height*1.43;
	}
	
	function scrollEvent(e){
		var id = baseName(e);
		var delta = 0;
	
		//var start_a = new Date().getTime();
	
		if(IE){
			s_initialX = event.clientX + document.body.scrollLeft;
			s_initialY = event.clientY + document.body.scrollTop;
			if(!event){event = window.event;}
	    	var delta = event.wheelDelta / 40;
		}else{
			s_initialX = e.pageX;
			s_initialY = e.pageY;
		}
	
		if(e.detail){
			var delta = -e.detail*5;
			var max = 8;
			if(delta > max){delta = max;}
			if(delta < -max){delta = -max;}
			zoom_shape(Math.round(delta*0.2)/20,s_initialX,s_initialY);
		}
	
		if(e.wheelDelta){ // SAFARI
			var delta = e.wheelDelta;
			var max = 60;
			if(delta > max){delta = max;}
			if(delta < -max){delta = -max;}
			zoom_shape(Math.round(delta*0.1)/20,s_initialX,s_initialY);
		}
	
		//var end_a = new Date().getTime();
		//document.getElementById("div_status").innerHTML += (end_a - start_a) + ' msec<br />';
	
	}
	
	function setKeyEvent(eventin,dist){
		currentEvent = eventin;
		d = dist;
	
		if (eventin !== "nothing" && eventin !== "refreshtozero"){
	
			doEvent();
			updateShapes();
	
			set_key_event_calls += 1;
	
			//document.getElementById("div_status").innerHTML = set_key_event_calls;
	
	//	var start_b = new Date().getTime();
	//	var end_b = new Date().getTime();
	//	alert('A: ' + (end_a - start_a) + ' msec' + '\n' + 'B: ' + (end_b - start_b) + ' msec');
		}
	}
	
	function setEvents(e) {
		var eventHandler = detectKeyDown;
		document['on'+this.id] = eventHandler;
	}
	
	function setViewboxProperties(){
		window_properties.height = getWindowHeight();
		window_properties.width = getWindowWidth();
	
		view_box.height = window_properties.height;
		view_box.width = window_properties.width;
	
		x_window_shift = view_box.width/2;
		y_window_shift = view_box.height/2;
	}
	
	function sortasc(a,b){
		return a - b;
	}
	
	function string_to_array_cs(string){
	
		var i, j;
		var t_arr = string.split(",");
	
		r_arr = new Array();
		for(i = 0;i < t_arr.length;i++){
			i_arr = trim(t_arr[i]).split(" ");
			
			r_arr[i] = new Array();
			for(j = 0;j < i_arr.length;j++) r_arr[i][j] = parseFloat(i_arr[j])
		}
	
		return r_arr;
	}
	
	function updateVisibility(){
	
		var i,j;
		var visibility;
		var layers = new Array();
	
		// CYCLE THROUGH TABLE ELEMENTS
		var div_control_panel_layers = document.getElementById("control_panel_layers");
		var items = div_control_panel_layers.getElementsByTagName("*");
		for (i = items.length; i--;) {
	
			if(items[i].tagName == 'TD' && items[i].name == 'label') layer = items[i].innerHTML;
	
			if(items[i].tagName == 'INPUT'){
				layers[i] = new Array();
				layers[i].name = layer;
				if(items[i].checked){layers[i].visibility = '';}else{layers[i].visibility = 'hidden';}
			}
		}	
	
		var items = svgDocument.getElementsByTagName("*");
		for (i = items.length; i--;) {
	
			visibility = '';
			for(j in layers) if(items[i].getAttribute("layer") == layers[j].name) visibility = layers[j].visibility;
			items[i].setAttribute("visibility", visibility);
		}
	}
	
	function toggle_div_visibility(id){
		div = document.getElementById(id);
		if(div.style.visibility == 'hidden'){
			div.style.visibility = '';
			div.style.height = '';
			//div.style.width = new_width + 'px';
		}else{
			div.style.visibility = 'hidden';
			div.style.height = '0px';
			div.style.width = '0px';
		}
	}
	
	function trim(stringToTrim){
		//http://www.somacon.com/p355.php
		return stringToTrim.replace(/^\s+|\s+$/g,"");
	}
	
	function ltrim(stringToTrim){
		//http://www.somacon.com/p355.php
		return stringToTrim.replace(/^\s+/,"");
	}
	
	function rtrim(stringToTrim){
		//http://www.somacon.com/p355.php
		return stringToTrim.replace(/\s+$/,"");
	}
</script>
<script type="text/javascript" >
	//var shape_tags = ['arrow', 'circle', 'line', 'path', 'pathC', 'point', 'polygon', 'text'];
	var shape_tags = ['circle', 'line', 'text', 'path', 'point'];
	var shape_names = firstToUpperCase(shape_tags);
	//var shape_transform = addC(shape_tags, 's').concat(['pointsAnimate']);
	var shape_transform = addC(shape_tags, 's').concat(addC(shape_tags, 'sAnimate'));
	
	// Create global arrays for shapes
	for (var i = 0, len = shape_tags.length; i < len; i++){
		eval(shape_tags[i] + 's = new Array();');
		eval(shape_tags[i] + 'sAttributes = new Array();');
		eval(shape_tags[i] + 'sAnimate = new Array();');
		eval(shape_tags[i] + 'sAnimateI = [];');
		eval(shape_tags[i] + 'sAttributesAnimate = new Array();');
		eval('var ' + shape_tags[i] + 's_animate;');
	}
	
	pathCs = new Array();
	pathCsAttributes = new Array();
	pathCsAttributesAnimate = new Array();
	
	ZOrders = new Array();
	Layers = new Array();
	
	var zoom = 280;
	var maxzoom = -200;
	var eyez = 300;
	var depth = Math.floor(zoom * (eyez - maxzoom) / 100 + eyez);
	var margin = 40;
	
	var shape_properties = [
		'x', 'y', 'z', 
		'x1', 'y1', 'z1', 'x2', 'y2', 'z2', 
		'cx', 'cy', 'cz',
	];
	
	var attribute_properties = [
		'r', 'fill', 'stroke', 'fill_opacity', 'stroke_opacity', 'opacity', 'stroke_width', 
		'z_index', 'text_anchor', 'font_size', 'font_family', 'font_style', 
		'font_weight', 'letter_spacing', 'writing_mode', 'glyph_orientation_vertical'
	];
	
	var properties = shape_properties.concat(attribute_properties);
	var opacity_types = ['opacity', 'stroke_opacity', 'fill_opacity'];
	
	
	var animation_length = 0;
	var frame_width = 10;
	var object_name = 'shape_viewer_3d';
	var max_arrowhead_size = 15;
	
	view_box = new Array();
	window_properties = new Array();
	
	var set_key_event_calls = 0;
	
	var anim_n = 0;
	var arrow_angle = 25;
	var background_color;
	var currentEvent = "nothing";
	var globalkeypress = '';
	var IE = document.all ? true : false
	var initiate = 0;
	var zoom_speed = 5;
	var sort_shapes = 0;
	var stop_anim = 0;
	var svgns = "http://www.w3.org/2000/svg";
	var tempX = 0;
	var tempY = 0;
	var mousedown = 0;
	var path_max_iter = 1500; // Also max iteration for number of animation duration
	
	var point_color_r = 100;
	var point_color_g = 0;
	var point_color_b = 0;
	var point_opacity = 0.5;
	var point_radius = 4;
	
	var line_color_r = 0;
	var line_color_g = 0;
	var line_color_b = 0;
	var line_width = 1;
	var line_opacity = 1;
	
	var prevX, prevY;
	var ajax_output;
	
	test_array = new Array();
	
	zindex = new Array();
	Arrows = new Array();
	Images = new Array();
	Lines = new Array();
	LinesC = new Array();
	Paths = new Array();
	PathsC = new Array();
	points_i_to_k = new Array();
	RefPoints = new Array();
	Shapes = new Array();
	Textlinks = new Array();
	
	AnimatePoints = new Array();
	AnimateArrows = new Array();
	AnimateLines = new Array();
	
	Translate = new Array();
	Rotate = new Array();
	
	function addReverseAnimationStates(a){
		var i, j, k;
	
		for(i in a){
			for(j = a[i].length - 1;j >= 0;j--){
				var new_j = a[i].length;
				a[i][new_j] = new Array();
				for(k = 0;k < a[i][j].length;k++){
					a[i][new_j][k] = a[i][j][k];
				}
			}
		}
		return a;
	}
	
	function animateShapes(){
	
		var i, j, k, len, len_i, len_j;
		var shape;
		var anim_n_i = anim_n;
		
		// RESET FRAME NUMBER IF REACHED MAXIMUM
		if(anim_n == animation_length) anim_n = 0
		
		// INCREASE ANIMATION REPEAT COUNT
		if(anim_n < anim_n_i) animation_count++
	
		// IF MAXIMUM NUMBER OF REPEATS IS REACHED, STOP ANIMATION
		if(animation_repeat > -1 && animation_count > animation_repeat){
			clearInterval(intervalID);
			return;
		}
	
		// alert('Frame number: ' + anim_n + '\n' + 'Number of repeats: ' + animation_count)
	
		// ANIMATE SHAPES
		if(circles_animate){
			for(i = 0, len = circlesAnimate.length;i < len; i++){
				circles[circlesAnimateI[i]].x = circlesAnimate[i].x[anim_n];
				circles[circlesAnimateI[i]].y = circlesAnimate[i].y[anim_n];
				circles[circlesAnimateI[i]].z = circlesAnimate[i].z[anim_n];
				circles[circlesAnimateI[i]].r = circlesAnimate[i].r[anim_n];
			}
		}
	
		if(lines_animate){
			for(i = 0, len = linesAnimate.length;i < len; i++){
				lines[linesAnimateI[i]].x1 = linesAnimate[i].x1[anim_n];
				lines[linesAnimateI[i]].y1 = linesAnimate[i].y1[anim_n];
				lines[linesAnimateI[i]].z1 = linesAnimate[i].z1[anim_n];
				lines[linesAnimateI[i]].x2 = linesAnimate[i].x2[anim_n];
				lines[linesAnimateI[i]].y2 = linesAnimate[i].y2[anim_n];
				lines[linesAnimateI[i]].z2 = linesAnimate[i].z2[anim_n];
			}
		}
	
		if(points_animate){
			for(i = 0, len = pointsAnimate.length;i < len; i++){
				points[pointsAnimateI[i]].x = pointsAnimate[i].x[anim_n];
				points[pointsAnimateI[i]].y = pointsAnimate[i].y[anim_n];
				points[pointsAnimateI[i]].z = pointsAnimate[i].z[anim_n];
			}
		}
	
		if(texts_animate){
			for(i = 0, len = textsAnimate.length;i < len; i++){
				texts[textsAnimateI[i]].x = textsAnimate[i].x[anim_n];
				texts[textsAnimateI[i]].y = textsAnimate[i].y[anim_n];
				texts[textsAnimateI[i]].z = textsAnimate[i].z[anim_n];
			}
		}
	
		// ANIMATE ATTRIBUTES
	
		if(circles_attributes_animate){
	
			for(i = 0, len_i = circlesAttributesAnimate.length;i < len_i; i++){
				for(j = 0, len_j = attribute_properties.length;j < len_j; j++){
	
					if(circlesAttributesAnimate[i][attribute_properties[j]] == null) continue
	
					circlesAttributes[circlesAttributesAnimate[i].i][attribute_properties[j]] = 
						circlesAttributesAnimate[i][attribute_properties[j]][anim_n];
				}
	
				shape = svgDocument.getElementById('circle' + circlesAttributesAnimate[i].i);
				shape.setAttribute("style", attributesToString(circlesAttributes[circlesAttributesAnimate[i].i]));
			}
		}
	
		if(lines_attributes_animate){
	
			for(i = 0, len_i = linesAttributesAnimate.length;i < len_i; i++){
				for(j = 0, len_j = attribute_properties.length;j < len_j; j++){
	
					if(linesAttributesAnimate[i][attribute_properties[j]] == null) continue
	
					linesAttributes[linesAttributesAnimate[i].i][attribute_properties[j]] = 
						linesAttributesAnimate[i][attribute_properties[j]][anim_n];
				}
	
				shape = svgDocument.getElementById('line' + linesAttributesAnimate[i].i);
				shape.setAttribute("style", attributesToString(linesAttributes[linesAttributesAnimate[i].i]));
			}
		}
	
		if(points_attributes_animate){
	
			for(i = 0, len_i = pointsAttributesAnimate.length;i < len_i; i++){
				for(j = 0, len_j = attribute_properties.length;j < len_j; j++){
	
					if(pointsAttributesAnimate[i][attribute_properties[j]] == null) continue
	
					pointsAttributes[pointsAttributesAnimate[i].i][attribute_properties[j]] = 
						pointsAttributesAnimate[i][attribute_properties[j]][anim_n];
				}
	
				shape = svgDocument.getElementById('point' + pointsAttributesAnimate[i].i);
				shape.setAttribute("style", attributesToString(pointsAttributes[pointsAttributesAnimate[i].i]));
				if(pointsAttributesAnimate[i].r !== null) shape.setAttribute("r", pointsAttributesAnimate[i].r[anim_n]);
			}
		}
	
		if(texts_attributes_animate){
	
			for(i = 0, len_i = textsAttributesAnimate.length;i < len_i; i++){
				for(j = 0, len_j = attribute_properties.length;j < len_j; j++){
	
					if(textsAttributesAnimate[i][attribute_properties[j]] == null) continue
	
					textsAttributes[textsAttributesAnimate[i].i][attribute_properties[j]] = 
						textsAttributesAnimate[i][attribute_properties[j]][anim_n];
				}
	
				shape = svgDocument.getElementById('text' + textsAttributesAnimate[i].i);
				shape.setAttribute("style", attributesToString(textsAttributes[textsAttributesAnimate[i].i]));
			}
		}
	
		anim_n++;
		updateShapes();
	
		return;
	
		animation_length_wreverse = animation_length
		if(animation_reverse) animation_length_wreverse = animation_length*2
	
		if(Translate.length > 0){
			if((animation_count*animation_length_wreverse + anim_n) < Translate.length){
				currentEvent = "translateX";
				d = Translate[anim_n][0];
				doEvent();
		
				currentEvent = "translateY";
				d = Translate[anim_n][1];
				doEvent();
		
				currentEvent = "translateZ";
				d = Translate[anim_n][2];
				doEvent();
			}
		}
	
		if(Rotate.length > 0){
			if((animation_count*animation_length_wreverse + anim_n) < Rotate.length){
				currentEvent = "rotateXaxis";
				d = Rotate[anim_n][0];
				doEvent();
		
				currentEvent = "rotateYaxis";
				d = Rotate[anim_n][1];
				doEvent();
		
				currentEvent = "rotateZaxis";
				d = Rotate[anim_n][2];
				doEvent();
			}
		}
	}
	
	function changeLayerOpacity(layer, opacity){
	
		var i, j, len, len_j;
		var match;
		var shape;
		var opacity_i, stroke_opacity_i, fill_opacity_i;
		var animate_idx;
	
		// Add shapes to SVG document
		for (i = 0, len = Layers.length; i < len; i++) {
	
			match = false;
			
			if(Layers[i].layer.length == 1){
				
				if(Layers[i].layer == layer) match = true;
	
			}else{
				for (j = 0, len_j = Layers[i].layer.length; j < len_j; j++) if(Layers[i].layer[j] == layer) match = true;
			}
			
			if(!match) continue;
			
			var opacity_i;
			var stroke_opacity_i;
			var fill_opacity_i;
			var opacity_animate_i;
			var stroke_opacity_animate_i;
			var fill_opacity_animate_i;
	
			for (j = 0, len_j = opacity_types.length; j < len_j; j++){
	
				eval(opacity_types[j] + '_i = ' + Layers[i].type + 'sAttributes[' + Layers[i].i 
					+ '].' + opacity_types[j] + ';')
	
				eval('if(' + opacity_types[j] + '_i !== undefined){' + Layers[i].type + 
					'sAttributes[' + Layers[i].i + '].' + opacity_types[j] + ' = ' + opacity + ';' + 
					'shape = svgDocument.getElementById(Layers[i].type + Layers[i].i);' + 
					'shape.setAttribute("style", attributesToString(' + Layers[i].type + 
					'sAttributes[' + Layers[i].i + ']));}');
			}
	
			if(Layers[i].type !== 'path'){
	
				eval('animate_idx = ' + Layers[i].type + 'sAttributes[' + Layers[i].i + '].animate');
	
				if(animate_idx !== null){
					for (j = 0, len_j = opacity_types.length; j < len_j; j++){
	
						eval(opacity_types[j] + '_i = ' + Layers[i].type + 'sAttributesAnimate[' + animate_idx 
							+ '].' + opacity_types[j] + ';')
	
						eval('if(' + opacity_types[j] + '_i !== undefined && ' + opacity_types[j] + 
							'_i !== null){' + Layers[i].type + 'sAttributesAnimate[' + animate_idx 
							+ '].' + opacity_types[j] + ' = null;}');
					}
				}
			}
		}
	}
	
	function fitShapesToWindow(){
	
		var i;
		var len;
		var shape_limits;
		var xmin = [], xmax = [], ymin = [], ymax = [], zmin = [], zmax = [];
	
		// Get coordinate limits in space
		for (i = 0, len = shape_transform.length; i < len; i++){
	
			// Get limits for each shape
			eval('shape_limits = limits(' + shape_transform[i] + ');');
	
			// Add limits to array
			xmin.push(shape_limits.xmin);
			xmax.push(shape_limits.xmax);
			ymin.push(shape_limits.ymin);
			ymax.push(shape_limits.ymax);
			zmin.push(shape_limits.zmin);
			zmax.push(shape_limits.zmax);
		}
	
		// Remove NaN values
		xmin = clean(xmin, NaN);
		xmax = clean(xmax, NaN);
		ymin = clean(ymin, NaN);
		ymax = clean(ymax, NaN);
		zmin = clean(zmin, NaN);
		zmax = clean(zmax, NaN);
	
		// Find ranges for all shapes
		xmin = Math.min.apply(Math, xmin);
		ymin = Math.min.apply(Math, ymin);
		zmin = Math.min.apply(Math, zmin);
	
		// Find ranges
		var x_range = Math.max.apply(Math, xmax) - xmin;
		var y_range = Math.max.apply(Math, ymax) - ymin;
		var z_range = Math.max.apply(Math, zmax) - zmin;
	
		if(isNaN(x_range) || isNaN(y_range) || isNaN(z_range)) return;
	
		if(x_range == 0){
			xmin = -1
			xmax = 1
			x_range = 2
		}
		if(y_range == 0){
			ymin = -1
			ymax = 1
			y_range = 2
		}
		if(z_range == 0){
			zmin = -1
			zmax = 1
			z_range = 2
		}
	
		var mm_to_pixel = (-(depth - eyez) / - eyez);
	
		var view_width = getWindowWidth() - 2*margin;
		var view_height = getWindowHeight() - 2*margin;
	
		var rw = (x_range*mm_to_pixel)/view_width;
		var rh = (y_range*mm_to_pixel)/view_height;
		var rd = (z_range*mm_to_pixel)/view_height;
	
		if(x_range*mm_to_pixel > view_width){
			if(rw > rh){
				if(rd > rw){var factor = 1/rd*2;}else{var factor = 1/rw;}
			}else{
				if(rd > rh){var factor = 1/rd*2;}else{var factor = 1/rh;}		
			}
		}else{
			if(rw > rh){
				if(rd > rw){var factor = 1/rd;}else{var factor = 1/rw;}
			}else{
				if(rd > rh){var factor = 1/rd;}else{var factor = 1/rh;}		
			}
		}
	
		// Find center
		var center = [(xmin + x_range/2), (ymin + y_range/2), (zmin + z_range/2)];
	
		// Center all shapes
		for (i = 0, len = shape_transform.length; i < len; i++) eval('translate(' + shape_transform[i] + ', ' + -center[0] + ', ' + -center[1] + ', ' + -center[2] + ')');
	
		// Scale all shapes
		for (i = 0, len = shape_transform.length; i < len; i++) eval('scale(' + shape_transform[i] + ', ' + factor + ')');
	
		return;
	}
	
	function getMouseMoveXY(e){
	
		//document.getElementById("div_status").innerHTML = e.clientX + ', ' + e.clientY;
	
		if(initiate == 0){
			prevX = initialX;
			prevY = initialY;
		}
		initiate = 1;
	
		if(IE){
			tempX = e.clientX + document.body.scrollLeft;
			tempY = e.clientY + document.body.scrollTop;
		}else{
			tempX = e.pageX;
			tempY = e.pageY;
		}  
	
		if (tempX < 0){tempX = 0;}
		if (tempY < 0){tempY = 0;}  
		if(mousedown == 1 && globalkeypress == ''){
	
			distX = tempX - prevX;
			distY = prevY - tempY;
			
			if(distX !== 0){setKeyEvent("translateX", Math.round(distX/4.667));}  // manually calibrated
			if(distY !== 0){setKeyEvent("translateY", Math.round(distY/4.667));}
		}
		if(mousedown == 1 && globalkeypress == 'r'){
			distX = tempX - prevX;
			distY = prevY - tempY;
			
			if(distX !== 0){setKeyEvent("rotateYaxis", Math.round(-distX));}
			if(distY !== 0){setKeyEvent("rotateXaxis", Math.round(distY));}
		}
	
		prevX = tempX
		prevY = tempY
	
		return false;
	}
	
	function get_transformations(){
	
		if(document.getElementsByTagName("transformation").length){
			for(i = 0;i < document.getElementsByTagName("transformation").length;i++){
	
				var svg_elem = document.getElementsByTagName("transformation")[i];
	
				// SET TRANSLATE ARRAY
				if(svg_elem.getAttribute("translate") !== null) Translate = Translate.concat(string_to_array_cs(svg_elem.getAttribute("translate")))
	
				// SET ROTATE ARRAY
				if(svg_elem.getAttribute("rotate") !== null) Rotate = Rotate.concat(string_to_array_cs(svg_elem.getAttribute("rotate")))
			}
		}
	}
	
	function getShapes(){
	
		var i, j, k;
		var len_j, len_k;
		var doc_shapes;
		var doc_shapes_len;
		var property_name;
		var attributes_animate;
		var array_reverse;
	
		// ADD LINESC TO SHAPES FOR LOCAL USE ONLY
		var shape_tags_loc = shape_tags.slice();
		shape_tags_loc.push('pathC');
	
		for(i = 0; i < shape_tags_loc.length; i++){
			
			doc_shapes = document.getElementsByTagName(shape_tags_loc[i])
			
			if(!doc_shapes.length) continue;
			
			for(j = 0, len_j = doc_shapes.length;j < len_j; j++){
	
				// CLEAR PROPERTY VARIABLES
				for(k = 0, len_k = properties.length;k < len_k; k++)
					eval("var " + properties[k] + " = null;var " + properties[k] + "_init = null;");
	
				// SET SHAPE PROPERTIES
				for(k = 0, len_k = shape_properties.length;k < len_k; k++){
	
					property_name = shape_properties[k].replace(/_/g, '-')
	
					if(doc_shapes[j].getAttribute(property_name) == null) continue;
					
					if(doc_shapes[j].getAttribute(property_name).indexOf(',') > -1){
	
						eval(shape_properties[k] + " = doc_shapes[j].getAttribute(\"" + property_name + "\").split(\",\");");
	
						// ADD REVERSE STATES
						if(animation_reverse){
							eval("array_reverse = " + shape_properties[k] + ".slice();");
							eval(shape_properties[k] + " = " + shape_properties[k] + ".concat(array_reverse.reverse());");
						}
						
						//if(shape_properties[k] == 'x') if(x.length > 1) alert(x)
	
						eval("animation_length = " + shape_properties[k] + ".length;");
						eval(shape_properties[k] + "_init = " + shape_properties[k] + "[0]");
					}else{
						eval(shape_properties[k] + "_init = doc_shapes[j].getAttribute(\"" + property_name + "\");");
						eval(shape_properties[k] + " = null");
					}
				}
	
				// SET ATTRIBUTE PROPERTIES
				attributes_animate = false;
				for(k = 0, len_k = attribute_properties.length;k < len_k; k++){
	
					property_name = attribute_properties[k].replace(/_/g, '-')
	
					if(doc_shapes[j].getAttribute(property_name) == null) continue;
					
					if(doc_shapes[j].getAttribute(property_name).indexOf(',') > -1){
						eval(attribute_properties[k] + " = doc_shapes[j].getAttribute(\"" + property_name + "\").split(\",\");");
	
						if(animation_reverse){
							eval("array_reverse = " + attribute_properties[k] + ".slice();");
							eval(attribute_properties[k] + " = " + attribute_properties[k] + ".concat(array_reverse.reverse());");
						}
	
						eval("animation_length = " + attribute_properties[k] + ".length;");
						eval(attribute_properties[k] + "_init = " + attribute_properties[k] + "[0]");
						attributes_animate = true;
					}else{
						eval(attribute_properties[k] + "_init = doc_shapes[j].getAttribute(\"" + property_name + "\");");
						eval(attribute_properties[k] + " = null");
					}
				}
	
				if(shape_tags_loc[i] == 'circle'){
	
					circles[j] = new circle(parseFloat(cx_init), parseFloat(cy_init), parseFloat(cz_init), parseFloat(r_init));
	
					if(cx !== null && r == null){
						r = Array.apply(null, new Array(cx.length)).map(String.prototype.valueOf, r_init);
					}
	
					if(cx == null && r !== null){
						cx = Array.apply(null, new Array(r.length)).map(String.prototype.valueOf, cx_init);
						cy = Array.apply(null, new Array(r.length)).map(String.prototype.valueOf, cy_init);
						cz = Array.apply(null, new Array(r.length)).map(String.prototype.valueOf, cz_init);
					}
	
					if(cx !== null){
						circlesAnimate[circlesAnimate.length] = new circleAnimate(
							cx.map(parseFloat), cy.map(parseFloat), cz.map(parseFloat), r.map(parseFloat)
						);
						circlesAnimateI.push(j);
					}
	
					circlesAttributes[j] = new shapeAttributes(
						(!fill_init ? "none" : fill_init),
						(!fill_opacity_init ? 1 : fill_opacity_init),
						(!stroke_init ? "black" : stroke_init),
						(!stroke_opacity_init ? 1 : stroke_opacity_init),
						(!stroke_width_init ? 1 : stroke_width_init),
						'',
						(!z_index_init ? 0 : z_index_init),
						(!attributes_animate ? null : circlesAttributesAnimate.length)
					);
	
					if(attributes_animate){
						circlesAttributesAnimate[circlesAttributesAnimate.length] = 
							new shapeAttributesAnimate(j, fill, fill_opacity, stroke, 
							stroke_opacity, stroke_width, r, z_index
						);
					}
				}
	
				if(shape_tags_loc[i] == 'line'){
	
					lines[j] = new line(
						parseFloat(x1_init), parseFloat(y1_init), parseFloat(z1_init), 
						parseFloat(x2_init), parseFloat(y2_init), parseFloat(z2_init));
	
					if(x1 !== null){
						linesAnimate[linesAnimate.length] = new lineAnimate(
							x1.map(parseFloat), y1.map(parseFloat), z1.map(parseFloat), 
							x2.map(parseFloat), y2.map(parseFloat), z2.map(parseFloat)
						);
						linesAnimateI.push(j);
					}
	
					linesAttributes[j] = new shapeAttributes(
						"none",
						"none",
						(!stroke_init ? "black" : stroke_init),
						(!stroke_opacity_init ? 1 : stroke_opacity_init),
						(!stroke_width_init ? 1 : stroke_width_init),
						'',
						(!z_index_init ? 0 : z_index_init),
						(!attributes_animate ? null : linesAttributesAnimate.length)
					);
	
					if(attributes_animate){
						linesAttributesAnimate[linesAttributesAnimate.length] = 
							new shapeAttributesAnimate(j, fill, fill_opacity, stroke, 
							stroke_opacity, stroke_width, r, z_index
						);
					}
				}
	
				if(shape_tags_loc[i] == 'pathC'){
					
					pathCs[j] = doc_shapes[j].getAttribute("d").split(",");
	
					pathCsAttributes[j] = new shapeAttributes(
						(!fill_init ? "none" : fill_init),
						(!fill_opacity_init ? 1 : fill_opacity_init),
						(!stroke_init ? "black" : stroke_init),
						(!stroke_opacity_init ? 1 : stroke_opacity_init),
						(!stroke_width_init ? 1 : stroke_width_init),
						'',
						(!z_index_init ? 0 : z_index_init),
						(!attributes_animate ? null : pathCsAttributesAnimate.length)
					);
	
					if(attributes_animate){
						pathCsAttributesAnimate[pathCsAttributesAnimate.length] = 
							new shapeAttributesAnimate(j, fill, fill_opacity, stroke, 
							stroke_opacity, stroke_width, r, z_index
						);
					}
				}
	
				if(shape_tags_loc[i] == 'path'){
	
					paths[j] = parseSVGPath(doc_shapes[j].getAttribute("d"))
	
					pathsAttributes[j] = new shapeAttributes(
						(!fill_init ? "none" : fill_init),
						(!fill_opacity_init ? 1 : fill_opacity_init),
						(!stroke_init ? "black" : stroke_init),
						(!stroke_opacity_init ? 1 : stroke_opacity_init),
						(!stroke_width_init ? 1 : stroke_width_init),
						'',
						(!z_index_init ? 0 : z_index_init),
						null
					);
				}
	
				if(shape_tags_loc[i] == 'point'){
	
					if(x !== null){
						pointsAnimate[pointsAnimate.length] = new pointAnimate(x.map(parseFloat), y.map(parseFloat), z.map(parseFloat));
						pointsAnimateI.push(j);
					}
	
					points[j] = new point(parseFloat(x_init), parseFloat(y_init), parseFloat(z_init));
	
					pointsAttributes[j] = new shapeAttributes(
						(!fill_init ? "none" : fill_init),
						(!fill_opacity_init ? 1 : fill_opacity_init),
						(!stroke_init ? "black" : stroke_init),
						(!stroke_opacity_init ? 1 : stroke_opacity_init),
						(!stroke_width_init ? 1 : stroke_width_init),
						(!r_init ? 1 : r_init),
						(!z_index_init ? 0 : z_index_init),
						(!attributes_animate ? null : pointsAttributesAnimate.length)
					);
	
					if(attributes_animate){
						pointsAttributesAnimate[pointsAttributesAnimate.length] = 
							new shapeAttributesAnimate(j, fill, fill_opacity, stroke, 
							stroke_opacity, stroke_width, r, z_index);
					}
				}
	
				if(shape_tags_loc[i] == 'text'){
	
					if(x !== null){
						textsAnimate[textsAnimate.length] = new pointAnimate(x.map(parseFloat), y.map(parseFloat), z.map(parseFloat));
						textsAnimateI.push(j);
					}
	
					texts[j] = new point(parseFloat(x_init), parseFloat(y_init), parseFloat(z_init));
	
					textsAttributes[j] = new textAttributes(
						doc_shapes[j].childNodes[0].nodeValue,
						(!text_anchor_init ? "middle" : text_anchor_init),
						(!font_size_init ? 12 : font_size_init),
						(!fill_init ? "black" : fill_init),
						(!opacity_init ? 1 : opacity_init),
						(!font_family_init ? "Arial" : font_family_init),
						(!font_style_init ? "" : font_style_init),
						(!font_weight_init ? "" : font_weight_init),
						(!letter_spacing_init ? 0 : letter_spacing_init),
						(!writing_mode_init ? "" : writing_mode_init),
						(!glyph_orientation_vertical_init ? "" : glyph_orientation_vertical_init),
						(!z_index_init ? 0 : z_index_init),
						(!attributes_animate ? null : textsAttributesAnimate.length)
					);
	
					if(attributes_animate){
						textsAttributesAnimate[textsAttributesAnimate.length] = 
							new textAttributesAnimate(j, text_anchor, font_size, fill, 
							opacity, font_family, font_style, font_weight, letter_spacing, 
							writing_mode, glyph_orientation_vertical, z_index);
					}
				}
	
				ZOrders.push(new ZOrder( (!z_index_init ? 0 : z_index_init), j, shape_tags_loc[i] ));
	
				if(doc_shapes[j].getAttribute("layer") !== null)
					Layers.push(new Layer(doc_shapes[j].getAttribute("layer").split(","), j, shape_tags_loc[i]));
			}
		}
	
		// SET REFERENCE POINTS
		RefPoints = new Array(0,0,0)
	}
	
	function getWindowSizeProjection(z){
	
		if(z == null) var z = RefPoints[0][2];
	
		var x_window_shift = getWindowWidth()/2;
		var y_window_shift = getWindowHeight()/2;
	
		var min_x = -(z - eyez)*(-x_window_shift)/(depth - eyez) - RefPoints[0][0]
		var max_x = -(z - eyez)*(x_window_shift)/(depth - eyez) - RefPoints[0][0]
	
		var min_y = -(z - eyez)*(-y_window_shift)/(depth - eyez) - RefPoints[0][1]
		var max_y = -(z - eyez)*(y_window_shift)/(depth - eyez) - RefPoints[0][1]
	
		//alert(min_x + ', ' + max_x + ', ' + min_y + ', ' + max_y);
	
		return {min_x : min_x, max_x : max_x, min_y : min_y, max_y : max_y, range_x : max_x-min_x, range_y : max_y-min_y};
	}
	
	function loadBackground(){
	
		if(document.getElementsByTagName("background").length){
			for(i = 0;i < document.getElementsByTagName("background").length;i++){
	
				var svg_elem = document.getElementsByTagName("background")[i];
				background_color  = svg_elem.getAttribute("color");
	
				var rect = document.createElementNS(svgns, "rect");
	
				rect.setAttribute("width", window_properties.width*4);
				rect.setAttribute("height", window_properties.height*4);
				rect.setAttribute("x", 0);
				rect.setAttribute("y", 0);
				rect.setAttribute("fill", background_color);
				svgDocument.appendChild(rect);
			}
		}else{
			background_color = "white";
		}
	}
	
	function onLoadFunctions(evt){
	
		svgns = "http://www.w3.org/2000/svg";
		XLINK = "http://www.w3.org/1999/xlink";
	
		svgDocument = document.getElementById("world");
	
		window.onresize = function(event) {
			onWindowResize();
			updateShapes();
		}
	
		if(BrowserDetect.browser == "Firefox"){
			svgDocument.style.width = getWindowWidth() + "px";
			svgDocument.style.height = getWindowHeight() + "px";
		}
	
		document.getElementById('keydown').focus();
		document.getElementById('keydown').onclick = setEvents;
		document.getElementById('keydown').onclick();
		document.onkeyup = detectKeyUp;
		//document.onmousemove = getMouseMoveXY;
		//document.onmousedown = mouseDownEvent;
		//document.onmouseup = mouseUpEvent;
	
		svgDocument.onmousemove = getMouseMoveXY;
		svgDocument.onmousedown = mouseDownEvent;
		svgDocument.onmouseup = mouseUpEvent;
	
		svgDocument.onkeyup = detectKeyUp;
		svgDocument.onkeydown = detectKeyDown;
		if(window.addEventListener){svgDocument.addEventListener('DOMMouseScroll', scrollEvent, false);}
		svgDocument.onmousewheel = scrollEvent;
	
		setViewboxProperties();
		getShapes();
		get_transformations();
		setAnimationParameters();
	
	//	if(AnimatePoints[0]) animation_length = AnimatePoints[0].length;	
	//	if(AnimateArrows[0]) animation_length = AnimateArrows[0].length;	
	//	if(AnimateLines[0]) animation_length = AnimateLines[0].length;	
	
		loadBackground();
		renderShapes();
	
		if(Images.length == 0){
			set_interzoom_interval = 0;
			zoom_scroll_strength = 0.1;
		}
	
		fitShapesToWindow();
	//	alert('h')
		updateShapes();
	
		if(animation_length > 1){
	//		if(animation_reverse){AnimatePoints = addReverseAnimationStates(AnimatePoints);}
	//		if(animation_reverse){AnimateArrows = addReverseAnimationStates(AnimateArrows);}
	//		if(animation_reverse){AnimateLines = addReverseAnimationStates(AnimateLines);}
			startAnimation();
		}
	}
	
	function onWindowResize(){
	
		if(BrowserDetect.browser == "Firefox"){
			svgDocument.style.width = getWindowWidth() + "px";
			svgDocument.style.height = getWindowHeight() + "px";
		}
	
		setViewboxProperties();
		fitShapesToWindow();
	}
	
	function pixel_to_font_size(pixel_height){
		return pixel_height*1.43;
	}
	
	function playPauseAnimation(){
		if(stop_anim == 1){clearInterval(intervalID);}else{startAnimation();}
	}
	
	function renderShapes(){ 	 	
	
		var i;
		var idx;
		var len;
		var shape;
		var svg_shape_type;
	
		// Sort by Z-Order
		ZOrders.sort(function(a,b){return a.z - b.z})
	
		// Add shapes to SVG document
		for (i = 0, len = ZOrders.length; i < len; i++) {
	
			idx = ZOrders[i].i;
	
			svg_shape_type = ZOrders[i].type;
			if(svg_shape_type == 'point') svg_shape_type = 'circle';
			if(svg_shape_type == 'pathC') svg_shape_type = 'path';
	
			shape = document.createElementNS(svgns, svg_shape_type);
			shape.setAttribute("id", ZOrders[i].type + idx);
	
			eval('shape.setAttribute("style", attributesToString(' + ZOrders[i].type + 'sAttributes[' + idx + ']))');
	
			if(ZOrders[i].type == 'text'){
				var textBlock = document.createTextNode(textsAttributes[idx].text);
				shape.appendChild(textBlock);
			}
	
			if(ZOrders[i].type == 'point') shape.setAttribute("r", pointsAttributes[idx].r);
	
			svgDocument.appendChild(shape);
		}
	
		return;
	}
	
	function setAnimationParameters(){
	
		var i, len;
		var property_length;
	
		for (i = 0, len = shape_tags.length; i < len; i++){
	
			property_length = 'x';
	
			if(shape_tags[i] == 'line') property_length = 'x1';
	
			eval('if(' + shape_tags[i] + 'sAnimate.length){' + shape_tags[i] + 's_animate = true;' + 
				'}else{' + shape_tags[i] + 's_animate = false;}');
		}
	
		// TEST WHETHER TO ANIMATE SHAPE ATTRIBUTES
		for (i = 0, len = shape_tags.length; i < len; i++){
	
			eval('if(' + shape_tags[i] + 'sAttributesAnimate.length){' + shape_tags[i] + 's_attributes_animate = true;' + 
				'}else{' + shape_tags[i] + 's_attributes_animate = false;}');
		}
	}
	
	function startAnimation(){
		if(animation_reverse){var animation_duration_n = animation_duration/2;}else{var animation_duration_n = animation_duration;}
		var animation_interval = (animation_duration_n*1000) / animation_length;
		intervalID = setInterval(animateShapes, Math.round(animation_interval));
	}
	
	function svg_path_string_to_array(string){
	
		var i, j, a;
		var s = "";
		
		// SPLIT PATH BY LETTERS, NUMBERS, SPACES OR COMMAS
		// TO ADD!!: Z AT THE END OF THE PATH
		m_arr = new Array();
		for(i=0;i < string.length;i++){
			a = string.substring(i, i+1);
	
			if(is_numeric(a) == is_numeric(s)) s += a
			if(a == " " || a == ","){
				m_arr[m_arr.length] = trim(s.toUpperCase());
				s = "";
			}
			if(is_numeric(a) !== is_numeric(s)){
				if(s.length) m_arr[m_arr.length] = trim(s.toUpperCase())
				s = a;
			}
		}
		m_arr[m_arr.length] = trim(s.toUpperCase());
	
		r_arr = new Array();
		if(is_numeric(m_arr[3])){
			for(j = 0, k = 0;j < m_arr.length;j = j + 4, k++){
				r_arr[k] = new Array();
				r_arr[k][0] = m_arr[j];
				r_arr[k][1] = parseFloat(m_arr[j+1]);
				r_arr[k][2] = parseFloat(m_arr[j+2]);
				r_arr[k][3] = parseFloat(m_arr[j+3]);
			}
		}else{
			if(m_arr[3] == "Q"){
	
				r_arr[0] = new Array();
				r_arr[0][0] = m_arr[0];
				r_arr[0][1] = parseFloat(m_arr[1]);
				r_arr[0][2] = parseFloat(m_arr[2]);
				for(j = 4, k = 1;j < m_arr.length;j = j + 2, k++){
					r_arr[k] = new Array();
					r_arr[k][0] = "";
					r_arr[k][1] = parseFloat(m_arr[j]);
					r_arr[k][2] = parseFloat(m_arr[j+1]);
				}
				r_arr[1][0] = "Q";
				if(!is_numeric(m_arr[m_arr.length-1])) r_arr[r_arr.length-1][0] = m_arr[m_arr.length-1]			
			}else{
				for(j = 0, k = 0;j < m_arr.length;j = j + 3, k++){
					r_arr[k] = new Array();
					r_arr[k][0] = m_arr[j];
					r_arr[k][1] = parseFloat(m_arr[j+1]);
					r_arr[k][2] = parseFloat(m_arr[j+2]);
				}
			}
		}
	
		return r_arr;
	}
	
	function updateShapes(){
	
		var i;
		var len;
		var shape;
	
		var i, j, k, n_i0, n_i1, pathd, u, u1, u2, len;
		var circle, line, n_i, type, visibility, vec;
		var x, y, x1, x2, y1, y2;
	
		wsize_proj = getWindowSizeProjection();
	
		// Find perspective projections for shapes
		for (i = 0, len = shape_tags.length; i < len; i++){
			eval('var ' + shape_tags[i] + 's_proj = project(' + shape_tags[i] + 's, depth, eyez, x_window_shift, y_window_shift);');
		}
	
		for (i = 0, len = circles_proj.length; i < len; i++) {
			var shape = svgDocument.getElementById('circle' + i);
			shape.setAttribute("cx", circles_proj[i].x);
			shape.setAttribute("cy", circles_proj[i].y);
			shape.setAttribute("r", circles_proj[i].r);
		}
	
		for (i = 0, len = lines_proj.length; i < len; i++) {
			var shape = svgDocument.getElementById('line' + i);
			shape.setAttribute("x1", lines_proj[i].x1);
			shape.setAttribute("y1", lines_proj[i].y1);
			shape.setAttribute("x2", lines_proj[i].x2);
			shape.setAttribute("y2", lines_proj[i].y2);
		}
	
		for (i = 0, len = texts_proj.length; i < len; i++) {
			var shape = svgDocument.getElementById('text' + i);
			shape.setAttribute("x", texts_proj[i].x);
			shape.setAttribute("y", texts_proj[i].y);
		}
	
		for (i = 0, len = points_proj.length; i < len; i++) {
			var shape = svgDocument.getElementById('point' + i);
			shape.setAttribute("cx", points_proj[i].x);
			shape.setAttribute("cy", points_proj[i].y);
		}
	
		for (i = 0, len = paths_proj.length; i < len; i++) {
			var shape = svgDocument.getElementById('path' + i);
			shape.setAttribute("d", pathToString(paths_proj[i]));
		}
	
		for (i = 0, len = pathCs.length; i < len; i++) {
			var shape = svgDocument.getElementById('pathC' + i);
			shape.setAttribute("d", pointsToPath(points_proj, pathCs[i]));
		}
	
		return;
	}
	
	function zoom_shape(d, mouseX, mouseY){
		if(d == 0){return;}
	
		var zoom_speed_n = zoom_speed;
		if(BrowserDetect.browser == "Firefox") var zoom_speed_n = zoom_speed*0.5;
	
		var d = d/zoom_speed_n;
	
		// Scale all shapes
		for (i = 0, len = shape_transform.length; i < len; i++) eval('scale(' + shape_transform[i] + ', ' + [1 + d] + ')');
	
		updateShapes();
	}
</script>
<script type="text/javascript" >
	//******************************** Shape constructors **********************************//
	
	function circle(x, y, z, r) {
		this.x = x;
		this.y = y;
		this.z = z;
		this.r = r;
	}
	
	function circleAnimate(x, y, z, r) {
		this.x = x;
		this.y = y;
		this.z = z;
		this.r = r;
	}
	
	function circleProject(x, y, r) {
		this.x = x;
		this.y = y;
		this.r = r;
	}
	
	function line(x1, y1, z1, x2, y2, z2) {
		this.x1 = x1;
		this.y1 = y1;
		this.z1 = z1;
		this.x2 = x2;
		this.y2 = y2;
		this.z2 = z2;
	}
	
	function lineAnimate(x1, y1, z1, x2, y2, z2) {
		this.x1 = x1;
		this.y1 = y1;
		this.z1 = z1;
		this.x2 = x2;
		this.y2 = y2;
		this.z2 = z2;
	}
	
	function lineProject(x1, y1, x2, y2) {
		this.x1 = x1;
		this.y1 = y1;
		this.x2 = x2;
		this.y2 = y2;
	}
	
	function path(x, y, z, d, close) {
		this.x = x;
		this.y = y;
		this.z = z;
		this.d = d;
		this.close = close;
	}
	
	function pathProject(x, y, d, close) {
		this.x = x;
		this.y = y;
		this.d = d;
		this.close = close;
	}
	
	function point(x, y, z) {
		this.x = x;
		this.y = y;
		this.z = z;
	}
	
	function pointAnimate(x, y, z, i) {
		this.x = x;
		this.y = y;
		this.z = z;
		this.i = i;
	}
	
	function pointProject(x, y) {
		this.x = x;
		this.y = y;
	}
	
	function ZOrder(z, i, type){
		this.z = z;
		this.i = i;
		this.type = type;
	}
	
	function Layer(layer, i, type){
		this.layer = layer;
		this.i = i;
		this.type = type;
	}
	
	//*************************** Shape attribute constructors *****************************//
	
	function shapeAttributes(fill, fill_opacity, stroke, stroke_opacity, stroke_width, r, z_index, animate) {
		this.fill = fill;
		this.fill_opacity = fill_opacity;
		this.stroke = stroke;
		this.stroke_opacity = stroke_opacity;
		this.stroke_width = stroke_width;
		this.z_index = z_index;
		this.r = r;
		this.animate = animate;
	}
	
	function shapeAttributesAnimate(i, fill, fill_opacity, stroke, stroke_opacity, stroke_width, r, z_index) {
		this.i = i;
		this.fill = fill;
		this.fill_opacity = fill_opacity;
		this.stroke = stroke;
		this.stroke_opacity = stroke_opacity;
		this.stroke_width = stroke_width;
		this.r = r;
		this.z_index = z_index;
	}
	
	function textAttributes(text, text_anchor, font_size, fill, opacity, font_family, font_style, font_weight, letter_spacing, writing_mode, glyph_orientation_vertical, z_index, animate) {
		this.text = text;
		this.text_anchor = text_anchor;
		this.font_size = font_size;
		this.fill = fill;
		this.opacity = opacity;
		this.font_family = font_family;
		this.font_style = font_style;
		this.font_weight = font_weight;
		this.letter_spacing = letter_spacing;
		this.writing_mode = writing_mode;
		this.glyph_orientation_vertical = glyph_orientation_vertical;
		this.z_index = z_index;
		this.animate = animate;
	}
	
	function textAttributesAnimate(i, text_anchor, font_size, fill, opacity, font_family, font_style, font_weight, letter_spacing, writing_mode, glyph_orientation_vertical, z_index) {
		this.i = i;
		this.text_anchor = text_anchor;
		this.font_size = font_size;
		this.fill = fill;
		this.opacity = opacity;
		this.font_family = font_family;
		this.font_style = font_style;
		this.font_weight = font_weight;
		this.letter_spacing = letter_spacing;
		this.writing_mode = writing_mode;
		this.glyph_orientation_vertical = glyph_orientation_vertical;
		this.z_index = z_index;
	}
	
	//*********************************** Shape methods ************************************//
	
	circle.prototype = {
	    scale: function (s) {
			this.x *= s;
			this.y *= s;
			this.z *= s;
			this.r *= s;
	    },
	
	    rotateXaxis: function (t) {rotateX1(this, t);},
	    rotateYaxis: function (t) {rotateY1(this, t);},
	    rotateZaxis: function (t) {rotateZ1(this, t);},
	
		translateX: function (d) {this.x += d;},
	    translateY: function (d) {this.y += d;},
	    translateZ: function (d) {this.z += d;},
	
	    translate: function (dx, dy, dz) {
			this.x += dx;
			this.y += dy;
			this.z += dz;
	    },
	
	    project: function (d, e, xs, ys) {
			var u = -(d - e) / (this.z - e);
			return new circleProject((u * this.x) + xs, -(u * this.y) + ys, this.r);
	    },
	
	    limits: function () {return {x:[this.x + this.r, this.x - this.r], y:[this.y + this.r, this.y - this.r], z:[this.z]};}
	}
	
	line.prototype = {
	    scale: function (s) {
			this.x1 *= s;
			this.y1 *= s;
			this.z1 *= s;
			this.x2 *= s;
			this.y2 *= s;
			this.z2 *= s;
	    },
	
	    rotateXaxis: function (t) {
			var tmp = this.y1;
			this.y1 = (t.cos * this.y1) - (t.sin * this.z1);
			this.z1 = (t.sin * tmp) + (t.cos * this.z1);
			var tmp = this.y2;
			this.y2 = (t.cos * this.y2) - (t.sin * this.z2);
			this.z2 = (t.sin * tmp) + (t.cos * this.z2);
	    },
	    rotateYaxis: function (t) {
			var tmp = this.x1;
			this.x1 = (t.cos * this.x1) + (t.sin * this.z1);
			this.z1 = - (t.sin * tmp) + (t.cos * this.z1);
			var tmp = this.x2;
			this.x2 = (t.cos * this.x2) + (t.sin * this.z2);
			this.z2 = - (t.sin * tmp) + (t.cos * this.z2);
	    },
	    rotateZaxis: function (t) {
			var tmp = this.x1;
			this.x1 = (t.cos * this.x1) - (t.sin * this.y1);
			this.y1 = (t.sin * tmp) + (t.cos * this.y1);
			var tmp = this.x2;
			this.x2 = (t.cos * this.x2) - (t.sin * this.y2);
			this.y2 = (t.sin * tmp) + (t.cos * this.y2);
	    },
	
	    translateX: function (d) {this.x1 += d;this.x2 += d;},
	    translateY: function (d) {this.y1 += d;this.y2 += d;},
	    translateZ: function (d) {this.z1 += d;this.z2 += d;},
	
	    translate: function (dx, dy, dz) {
			this.x1 += dx;
			this.y1 += dy;
			this.z1 += dz;
			this.x2 += dx;
			this.y2 += dy;
			this.z2 += dz;
	    },
	
	    project: function (d, e, xs, ys) {
			var u1 = -(d - e) / (this.z1 - e);
			var u2 = -(d - e) / (this.z2 - e);
			return new lineProject((u1 * this.x1) + xs,-(u1 * this.y1) + ys, (u2 * this.x2) + xs, -(u2 * this.y2) + ys);
	    },
	
	    limits: function () {return {x:[this.x1, this.x2], y:[this.y1, this.y2], z:[this.z1, this.z2]}}
	}
	
	path.prototype = {
	 
	    scale: function (s) {
			this.x = multC(this.x, s);
			this.y = multC(this.y, s);
			this.z = multC(this.z, s);
	    },
	
	    rotateXaxis: function (t) {rotateX2(this, t);},
	    rotateYaxis: function (t) {rotateY2(this, t);},
	    rotateZaxis: function (t) {rotateZ2(this, t);},
	
	    translateX: function (d) {this.x = addC(this.x, d);},
	    translateY: function (d) {this.y = addC(this.y, d);},
	    translateZ: function (d) {this.z = addC(this.z, d);},
	
	    translate: function (dx, dy, dz) {
			this.x = addC(this.x, dx);
			this.y = addC(this.y, dy);
			this.z = addC(this.z, dz);
	    },
	
		project: function(d, e, xs, ys){
			var u;
			var x = new Array(this.x.length);
			var y = new Array(this.x.length);
			for (var i = 0, len = this.x.length; i < len; i++){
				u = -(d - e) / (this.z[i] - e);
				x[i] = (u * this.x[i]) + xs;
				y[i] = -(u * this.y[i]) + ys;
			}
			//var u = multC(inv(addC(this.z, -e)), -(d - e));
			//return {x:addC(multC(this.x, u), xs), y:addC(multC(this.y, -u), ys), d:this.d, close:this.close};
			return new pathProject(x, y, this.d, this.close);
		},
	
	    limits: function () {
	    	return {
	    		x:[Math.min.apply(Math, this.x), Math.max.apply(Math, this.x)], 
	    		y:[Math.min.apply(Math, this.y), Math.max.apply(Math, this.y)], 
	    		z:[Math.min.apply(Math, this.z), Math.max.apply(Math, this.z)]
			};
	    }
	}
	
	point.prototype = {
	    scale: function (s) {
			this.x *= s;
			this.y *= s;
			this.z *= s;
	    },
	
	    rotateXaxis: function (t) {rotateX1(this, t);},
	    rotateYaxis: function (t) {rotateY1(this, t);},
	    rotateZaxis: function (t) {rotateZ1(this, t);},
	
	    translateX: function (d) {this.x += d;},
	    translateY: function (d) {this.y += d;},
	    translateZ: function (d) {this.z += d;},
	
	    translate: function (dx, dy, dz) {
			this.x += dx;
			this.y += dy;
			this.z += dz;
	    },
	
		project: function (d, e, xs, ys) {
			var u = -(d - e) / (this.z - e);
			return new pointProject((u * this.x) + xs, -(u * this.y) + ys);
		},
	
	    limits: function () {return {x:[this.x], y:[this.y], z:[this.z]};}
	}
	
	circleAnimate.prototype = {
	    scale: function (s) {
			this.x = multC(this.x, s);
			this.y = multC(this.y, s);
			this.z = multC(this.z, s);
			this.r = multC(this.r, s);
	    },
	
	    rotateXaxis: function (t) {rotateX2(this, t);},
	    rotateYaxis: function (t) {rotateY2(this, t);},
	    rotateZaxis: function (t) {rotateZ2(this, t);},
	
	    translateX: function (d) {this.x = addC(this.x, d);},
	    translateY: function (d) {this.y = addC(this.y, d);},
	    translateZ: function (d) {this.z = addC(this.z, d);},
	
	    translate: function (dx, dy, dz) {
			this.x = addC(this.x, dx);
			this.y = addC(this.y, dy);
			this.z = addC(this.z, dz);
	    },
	
	    limits: function () {
	    	return {
	    		x:[Math.min.apply(Math, add(this.x, this.r)), Math.min.apply(Math, sub(this.x, this.r)), Math.max.apply(Math, add(this.x, this.r)), Math.max.apply(Math, sub(this.x, this.r))], 
	    		y:[Math.min.apply(Math, add(this.y, this.r)), Math.min.apply(Math, sub(this.y, this.r)), Math.max.apply(Math, add(this.y, this.r)), Math.max.apply(Math, sub(this.y, this.r))], 
	    		z:[Math.min.apply(Math, add(this.z, this.r)), Math.min.apply(Math, sub(this.z, this.r)), Math.max.apply(Math, add(this.z, this.r)), Math.max.apply(Math, sub(this.z, this.r))], 
			};
	    }
	}
	
	pointAnimate.prototype = {
	    scale: function (s) {
			this.x = multC(this.x, s);
			this.y = multC(this.y, s);
			this.z = multC(this.z, s);
	    },
	
	    rotateXaxis: function (t) {rotateX2(this, t);},
	    rotateYaxis: function (t) {rotateY2(this, t);},
	    rotateZaxis: function (t) {rotateZ2(this, t);},
	
	    translateX: function (d) {this.x = addC(this.x, d);},
	    translateY: function (d) {this.y = addC(this.y, d);},
	    translateZ: function (d) {this.z = addC(this.z, d);},
	
	    translate: function (dx, dy, dz) {
			this.x = addC(this.x, dx);
			this.y = addC(this.y, dy);
			this.z = addC(this.z, dz);
	    },
	
	    limits: function () {
	    	return {
	    		x:[Math.min.apply(Math, this.x), Math.max.apply(Math, this.x)], 
	    		y:[Math.min.apply(Math, this.y), Math.max.apply(Math, this.y)], 
	    		z:[Math.min.apply(Math, this.z), Math.max.apply(Math, this.z)]
			};
	    }
	}
	
	lineAnimate.prototype = {
	    scale: function (s) {
			this.x1 = multC(this.x1, s);
			this.y1 = multC(this.y1, s);
			this.z1 = multC(this.z1, s);
			this.x2 = multC(this.x2, s);
			this.y2 = multC(this.y2, s);
			this.z2 = multC(this.z2, s);
	    },
	
	    rotateXaxis: function (t) {
			var tmp = this.y1;
			this.y1 = sub(multC(this.y1, t.cos), multC(this.z1, t.sin));
			this.z1 = add(multC(tmp, t.sin), multC(this.z1, t.cos));
			var tmp = this.y2;
			this.y2 = sub(multC(this.y2, t.cos), multC(this.z2, t.sin));
			this.z2 = add(multC(tmp, t.sin), multC(this.z2, t.cos));
	    },
	    rotateYaxis: function (t) {
			var tmp = this.x1;
			this.x1 = add(multC(this.x1, t.cos), multC(this.z1, t.sin));
			this.z1 = sub(multC(this.z1, t.cos), multC(tmp, t.sin));
			var tmp = this.x2;
			this.x2 = add(multC(this.x2, t.cos), multC(this.z2, t.sin));
			this.z2 = sub(multC(this.z2, t.cos), multC(tmp, t.sin));
	    },
	    rotateZaxis: function (t) {
			var tmp = this.x1;
			this.x1 = sub(multC(this.x1, t.cos), multC(this.y1, t.sin));
			this.y1 = add(multC(tmp, t.sin), multC(this.y1, t.cos));
			var tmp = this.x2;
			this.x2 = sub(multC(this.x2, t.cos), multC(this.y2, t.sin));
			this.y2 = add(multC(tmp, t.sin), multC(this.y2, t.cos));
	    },
	
	    translateX: function (d) {
	    	this.x1 = addC(this.x1, d);
	    	this.x2 = addC(this.x2, d);
	    },
	    translateY: function (d) {
	    	this.y1 = addC(this.y1, d);
	    	this.y2 = addC(this.y2, d);
	    },
	    translateZ: function (d) {
	    	this.z1 = addC(this.z1, d);
	    	this.z2 = addC(this.z2, d);
	    },
	
	    translate: function (dx, dy, dz) {
			this.x1 = addC(this.x1, dx);
			this.y1 = addC(this.y1, dy);
			this.z1 = addC(this.z1, dz);
			this.x2 = addC(this.x2, dx);
			this.y2 = addC(this.y2, dy);
			this.z2 = addC(this.z2, dz);
	    },
	
	   limits: function () {
	    	return {
	    		x:[Math.min.apply(Math, this.x1), Math.min.apply(Math, this.x2), Math.max.apply(Math, this.x1), Math.max.apply(Math, this.x2)], 
	    		y:[Math.min.apply(Math, this.y1), Math.min.apply(Math, this.y2), Math.max.apply(Math, this.y1), Math.max.apply(Math, this.y2)], 
	    		z:[Math.min.apply(Math, this.z1), Math.min.apply(Math, this.z2), Math.max.apply(Math, this.z1), Math.max.apply(Math, this.z2)]
			};
	    }
	}
	
	
	//********************************** Shape functions ***********************************//
	
	function attributesToString(attributes){
	
		s = "";
	
		if(attributes.stroke !== undefined) s += "stroke:" + attributes.stroke + ";";
		if(attributes.stroke_width !== undefined) s += "stroke-width:" + attributes.stroke_width + ";";
		if(attributes.stroke_opacity !== undefined) s += "stroke-opacity:" + attributes.stroke_opacity + ";";
		if(attributes.fill !== undefined) s += "fill:" + attributes.fill + ";";
		if(attributes.fill_opacity !== undefined) s += "fill-opacity:" + attributes.fill_opacity + ";";
		if(attributes.r !== undefined) s += "r:" + attributes.r + ";";
	
		if(attributes.opacity !== undefined) s += "opacity:" + attributes.opacity + ";";
		if(attributes.font_family !== undefined) s += "font-family:" + attributes.font_family + ";";
		if(attributes.font_size !== undefined) s += "font-size:" + attributes.font_size + ";";
		if(attributes.font_weight !== undefined) s += "font-weight:" + attributes.font_weight + ";";
		if(attributes.font_style !== undefined) s += "font-style:" + attributes.font_style + ";";
		if(attributes.letter_spacing !== undefined) s += "letter-spacing:" + attributes.letter_spacing + ";";
		if(attributes.text_anchor !== undefined) s += "text-anchor:" + attributes.text_anchor + ";";
		if(attributes.writing_mode !== undefined) s += "writing-mode:" + attributes.writing_mode + ";";
		if(attributes.glyph_orientation_vertical !== undefined) s += "glyph-orientation-vertical:" + attributes.glyph_orientation_vertical + ";";
	
		return s;
	}
	
	function parseSVGPath(path_in){
	
		// Add spaces between numbers and letters
		var str = path_in.replace(/((\.|-|\d)+)/g, function (_, num){return ' ' + num + ' ';}).trim();
	
		// Split path
		str_split = str.split(/[\s|,]/);
	
		// Remove empty values
		str_split = clean(str_split);
	
		// Check for z at the end (closed path), and if found remove from end
		var close = false;
		if(str_split[str_split.length-1] == 'Z' || str_split[str_split.length-1] == 'z'){
			close = true;
			str_split.pop();
		}
	
		var x = new Array();
		var y = new Array();
		var z = new Array();
		var d = new Array();
	
		// Sort into x,y,z coordinates and path type characters
		var num_ct = 0;
		for (var i = 0, len = str_split.length; i < len; i++){
	
			if(is_numeric(str_split[i])){
				if(num_ct == 0) x.push(parseFloat(str_split[i]));
				if(num_ct == 1) y.push(parseFloat(str_split[i]));
				if(num_ct == 2) z.push(parseFloat(str_split[i]));
				if(num_ct == 3){
					d.push(',');
					x.push(parseFloat(str_split[i]));
					num_ct = 1;
					continue;
				}
				num_ct++;
			}else{
				d.push(str_split[i]);
				num_ct = 0;
			}
		}
		
		//alert(str_split)
		//alert(x + '\n' + y + '\n' + z + '\n' + d + '\n' + close)
	
		return new path(x, y, z, d, close);
	}
	
	function pathToString(path){
	
		var str = "";
		for (var i = 0, len = path.x.length; i < len; i++){
			str += path.d[i] + ' ' + path.x[i] + ' ' + path.y[i] + ' ';
		}
		str = str.trim();
		if(path.close) str += ' Z';
	
		return str;
	}
	
	function pointsToPath(points, d){
	
		var str = "", let = "";
	
		for (var i = 0, len = d.length; i < len; i++){
			if(i == 0) letter = "M";
			if(i > 0) letter = "L";
			str += letter + " " + points[d[i]-1].x + " " + points[d[i]-1].y + " ";
		}
	
		str = str.trim();
	
		return str;
	}
	
	function project(object, d, e, xs, ys){
		var projection = new Array();
		for (var i = 0, len = object.length; i < len; i++) projection[i] = object[i].project(d, e, xs, ys);
		return projection;
	}
	
	function scale(object, s){
		for (var i = 0, len = object.length; i < len; i++) object[i].scale(s);
	}
	
	function translate(object, dx, dy, dz){
		for (var i = 0, len = object.length; i < len; i++) object[i].translate(dx, dy, dz);
	}
	
	function rotateXaxis(object, d){for (var i = 0, len = object.length; i < len; i++) object[i].rotateXaxis(rotateTrig(d));}
	function rotateYaxis(object, d){for (var i = 0, len = object.length; i < len; i++) object[i].rotateYaxis(rotateTrig(d));}
	function rotateZaxis(object, d){for (var i = 0, len = object.length; i < len; i++) object[i].rotateZaxis(rotateTrig(d));}
	
	function translateX(object, d){for (var i = 0, len = object.length; i < len; i++) object[i].translateX(d);}
	function translateY(object, d){for (var i = 0, len = object.length; i < len; i++) object[i].translateY(d);}
	function translateZ(object, d){for (var i = 0, len = object.length; i < len; i++) object[i].translateZ(d);}
	
	function limits(object){
	
		var shape_limits;
		var x = [], y = [], z = [];
	
		for (var i = 0, len = object.length; i < len; i++){
	
			shape_limits = object[i].limits();
	
			x.push.apply(x, shape_limits.x);
			y.push.apply(y, shape_limits.y);
			z.push.apply(z, shape_limits.z);
		}
	
		// Remove NaN values
		x = clean(x, NaN);
		y = clean(y, NaN);
		z = clean(z, NaN);
		
		return {
			xmin:Math.min.apply(Math, x), xmax:Math.max.apply(Math, x),
			ymin:Math.min.apply(Math, y), ymax:Math.max.apply(Math, y),
			zmin:Math.min.apply(Math, z), zmax:Math.max.apply(Math, z)
		}
	}
</script>
<script type="text/javascript" >
	function show_hide_control(element){
		
		var action;
		var class_name;
		var div_container = element.parentNode.parentNode;
		var i;
	
		for(i = 0; i < div_container.childNodes.length; i++){
	
			class_name = div_container.childNodes[i].className;
			
			if(class_name == undefined) continue
	
			if(class_name == 'control_main'){
	
				if(element.innerHTML == 'Show'){
					action = 'show';
					element.innerHTML = 'Hide';
					div_container.childNodes[i].style.display = '';
					document.getElementById("control_container").style.width = '300px';
				}else{
					action = 'hide';
					element.innerHTML = 'Show';
					div_container.childNodes[i].style.display = 'none';
					document.getElementById("control_container").style.width = '50px';
				}
			}
	
			if(class_name == 'control_layers_main' || class_name == 'control_layer_main'){
				if(element.innerHTML.charCodeAt(0) == 9660){
					action = 'hide';
					element.innerHTML = '&#9658;';
					div_container.childNodes[i].style.display = 'none';
				}else{
					action = 'show';
					element.innerHTML = '&#9660;';
					div_container.childNodes[i].style.display = '';
				}
			}
		}
	
		for(i = 0; i < div_container.childNodes.length; i++){
	
			class_name = div_container.childNodes[i].className;
			
			if(class_name == undefined) continue
	
			if(class_name == 'control_layer_subheader'){
				if(action == 'hide'){
					div_container.childNodes[i].style.display = 'none';
				}else{
					div_container.childNodes[i].style.display = '';
				}
	
			}
		}
	}
	
	function layer_visibility(element){
	
		var class_name;
		var div_header = element.parentNode.parentNode;
		var div_container = element.parentNode.parentNode.parentNode;
		var i;
		
		// Get parent layer
		for(i = 0; i < div_header.childNodes.length; i++){
	
			class_name = div_header.childNodes[i].className;
			if(class_name == undefined) continue
			if(class_name != 'control_layer_text' && class_name != 'control_layer_text_nochild') continue
	
			var parent_layer = div_header.childNodes[i].innerHTML;
		}
	
		// Find all child layers
		layers = find_layer_children(div_container)
	
		// Remove duplicate layer names
		layers = array_unique(layers)
	
		// Get opacity to apply to layers
		var opacity = element.value
	
		// Show hide all child layers and layers of the same name
		layer_visibility_children(document.getElementById("control_layers_container"), layers, opacity)
	}
	
	function layer_visibility_children(container, layers, opacity){
	
		var container_class;
		var header;
		var header_class;
		var layer_text;
		var main_class;
		var i, j, k;
		var idx_input;
		var idx_vis;
		var main;
	
		for(i = 0; i < container.childNodes.length; i++){
	
			container_class = container.childNodes[i].className;
	
			if(container_class == undefined) continue
	
			if(container_class == 'control_layer_header'){
	
				// Clear layer text
				layer_text;
	
				header = container.childNodes[i];
	
				for(j = 0; j < header.childNodes.length; j++){
					header_class = header.childNodes[j].className;
					if(header_class == 'control_layer_shape_vis_range') idx_vis = j;
					if(header_class == 'control_layer_text' || header_class == 'control_layer_text_nochild') layer_text = header.childNodes[j].innerHTML;
				}
				
				if(layer_text == undefined) continue
				
				if(layers.indexOf(layer_text) > -1){
	
					// Change opacity for any shapes that list layer
					changeLayerOpacity(layer_text, (opacity/100));
	
					// Find slider element
					for(k = 0; k < header.childNodes[idx_vis].childNodes.length; k++){
						if(header.childNodes[idx_vis].childNodes[k].tagName == 'INPUT') idx_input = k;
					}
					
					// Change opacity slider in control panel
					header.childNodes[idx_vis].childNodes[idx_input].value = opacity;
				}
			}
	
			if(container_class == 'control_layer_main' || container_class == 'control_layers_main') main = container.childNodes[i];
		}
	
		if(main == undefined) return;
	
		for(i = 0; i < main.childNodes.length; i++){
	
			main_class = main.childNodes[i].className;
	
			if(main_class == undefined || main_class != 'control_layer_container') continue
	
			layer_visibility_children(main.childNodes[i], layers, opacity)
		}
	}
	
	function find_layer_children(container, layers){
	
		var container_class;
		var header;
		var header_class;
		var main_class;
		var i, j;
		var main;
	
		if(layers == undefined) layers = [];
	
		for(i = 0; i < container.childNodes.length; i++){
	
			container_class = container.childNodes[i].className;
	
			if(container_class == undefined) continue
	
			if(container_class == 'control_layer_header'){
			
				header = container.childNodes[i];
	
				for(j = 0; j < header.childNodes.length; j++){
				
					header_class = header.childNodes[j].className;
	
					if(header_class != 'control_layer_text' && header_class != 'control_layer_text_nochild') continue
	
					layers.push(header.childNodes[j].innerHTML)
				}
			}
	
			if(container_class == 'control_layer_main') main = container.childNodes[i];
		}
	
		if(main == undefined) return layers;
	
		for(i = 0; i < main.childNodes.length; i++){
	
			main_class = main.childNodes[i].className;
	
			if(main_class == undefined || main_class != 'control_layer_container') continue
	
			layers.concat(find_layer_children(main.childNodes[i], layers))
		}
	
		return layers;
	}
</script>
