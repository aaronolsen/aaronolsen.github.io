<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<title>StereoMorph - Digitizing application</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
<link rel="shortcut icon" href="../../img/favicon.png"/>
<link href="../../css/stylesheet2.css" rel="stylesheet" type="text/css">

<body>
	<div id='container' class='container'>

		<div id='header' class='header' >
			<div style='position:relative;' >
				<img id='header_image' style='float:right;' src='../../img/headers/American Wigeon.jpg' />
				<div id='header_image_caption' style='color:white' class='header_image_caption' >
					American Wigeon
				</div>
			</div>
		</div>

		<div id='linksidebar' class='linksidebar' >
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../about_me.html'>About me</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../current_projects.html'>Current projects</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../software.html'>Software</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../tutorials/3d_visualization/plot_points.html'>Tutorials</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/3d_visualization/plot_points.html'>3D Visualization</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/morphometrics.html'>Shape analysis</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/mechanisms.html'>Mechanism models</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph.html'>StereoMorph User Guide</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/installing_stereomorph.html'>1 Getting started</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/choosing_cameras_general.html'>2 Choosing cameras</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/choose_checkerboard_size.html'>3 Creating a checkerboard</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/arranging_cameras_photography.html'>4 Arranging the cameras</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/calibration_general.html'>5 Calibrating stereo cameras</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/photographing_objects.html'>6 Photographing objects</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/digitizing_video.html'>7 Digitizing application</a>
			</div>
				<div class='linksidebar_sub3link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/digitizing_video.html'>7.1 Digitizing video frames</a>
			</div>
				<div class='linksidebar_sub3link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/digitizing_photographs.html'>7.2 Digitizing photographs</a>
			</div>
				<div class='linksidebar_sub3link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/digitizing_landmarks.html'>7.3 Digitizing landmarks</a>
			</div>
				<div class='linksidebar_sub3link_u' >
				<a class='linksidebar_link_u' href='../../tutorials/stereomorph/digitizing_curves.html'>7.4 Digitizing curves</a>
			</div>
				<div class='linksidebar_sub3link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/digitizing_moving.html'>7.5 Moving between images</a>
			</div>
				<div class='linksidebar_sub3link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/digitizing_shortcuts.html'>7.6 Keyboard shortcuts</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/reconstructing_landmarks.html'>8 Reconstruction</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/visualizing_shape.html'>9 Visualizing shape data</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/reflect_missing.html'>10 Reflecting bilateral landmarks</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/align_bilateral.html'>11 Aligning bilateral landmarks</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/extracting_frames.html'>12 Additional features</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/citing.html'>13 Citing StereoMorph</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/acknowledgements.html'>14 Acknowledgements</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/knex/large_u_joint.html'>K'nex models</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../contact.html'>Contact</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../cv.html'>CV</a>
			</div>
		</div>

		<div id='maincontent' class='maincontent' >

			<div id='pagetrail' class='pagetrail' ><a href="../../about_me.html">home</a>&nbsp;&nbsp;&nbsp;>&nbsp;&nbsp;&nbsp;<a href="../../tutorials/3d_visualization/plot_points.html">tutorials</a>&nbsp;&nbsp;&nbsp;>&nbsp;&nbsp;&nbsp;<a href="../../tutorials/stereomorph.html">stereomorph user guide</a>&nbsp;&nbsp;&nbsp;>&nbsp;&nbsp;&nbsp;<a href="../../tutorials/stereomorph/digitizing_video.html">7 digitizing application</a>&nbsp;&nbsp;&nbsp;>&nbsp;&nbsp;&nbsp;7.4 digitizing curves</div>


<div class="maincontentfill">
	<h1>7.4 Digitizing curves</h1>
	<p>
		The digitizing app allows you to digitize curves using 
		<a href='https://en.wikipedia.org/wiki/B%C3%A9zier_curve' target='_blank' >Bézier curves</a>.
		Bézier curves are constructed from a series of control points. Two control points 
		at each end of the curve determine its start and end point. Control points in 
		between control how the curve bends away from a straight line between the start 
		and end point.
	</p>

	<img width='300px' class='center' src='../../img/tutorials/stereomorph/3_point_bezier.jpg' />
	<div class='img_caption' >
		A 3-point Bézier curve with control points (red) and curve points (blue).
	</div>

	<p>
		The digitizing app only uses quadratic Bézier curves (3 control points) but an 
		unlimited number of these curves can be stringed together end-to-end as Bézier 
		splines. This allows a user to quickly and accurately fit a curve to a feature in 
		an image.
	</p>
	<p>
		To add a curve, click on the Curves panel at the right. You'll see a list of all 
		the curve names to the far right. Below each curve name are the start and end points 
		specified in <strong>curves.ref</strong>. These start and end points are treated the same 
		as landmarks in the digitizing app (they are added to the list in the Landmarks 
		panel if not already listed in <strong>landmarks.ref</strong>). Select the first landmark 
		of a curve by clicking on the corresponding row.
	</p>

	<img width='300px' class='center' src='../../img/tutorials/stereomorph/digitizing_select_curve_start.jpg' />

	<p>
		Position the curve start point on the image by double-clicking as described previously for 
		<a href='digitizing_landmarks.html' >Digitizing landmarks</a>.
		Then select the curve end point and position this at the end of the curve. Now all 
		that remains is to "fill in" a curve between these points. Select the empty row (with "-"'s) 
		between the start and end point. These are the intermediate control points that 
		will be used to define the Bézier spline.
	</p>

	<img width='300px' class='center' src='../../img/tutorials/stereomorph/digitizing_select_curve_mid.jpg' />

	<p>
		Add this point somewhere between the start and the end by double-clicking on the image. 
		Note that the curve doesn't pass through this point, it only "reaches" 
		toward it. You can change the shape of the curve by click-and-dragging this point.
	</p>

	<img width='500px' class='center' src='../../img/tutorials/stereomorph/drag_curve_control_point.jpg' />
	<div class='img_caption' >
		Change the curve shape by clicking and dragging the control points.
	</div>

	<p>
		For most curves a single intermediate point will probably not be enough to fit the 
		shape well. Once you add an intermediate point a new empty row will open up below 
		the current point in the Curves panel. Select this point and position it somewhere 
		near the curve. The curve will end at that intermediate point so select the next 
		empty row and add another intermediate point (for five points total, including the 
		start and end). Note that as you add control points they alternate between points 
		that the curve "reaches" to and points that the curve passes through; these 
		are Bézier curves lined up one after another to form a Bézier spline.
	</p>

	<img width='500px' class='center' src='../../img/tutorials/stereomorph/digitizing_fitted_bezier_splines.jpg' />
	<div class='img_caption' >
		Bézier splines digitized to fit the edge of the upper beak.
	</div>

	<p>
		Repeat this, adding additional intermediate points until you have a sufficient 
		number of points to fit the natural curve. To move back and forth between curve 
		points on a particular curve without having to click the rows in the Curves panel 
		you can use the keyboard shortcuts 'n' and 'p', for next and previous, respectively. 
		Just make sure that the curves are always complete (the total number of control 
		points must be odd). If the curve doesn't extend continuously between the start 
		and end landmarks then you'll either need to add or remove one intermediate point. 
		With a sufficient number of intermediate points you should be able to fit a spline 
		to pretty much any natural curve.
	</p>
	<p>
		If you are collecting curve data there is an additional consideration that will 
		effect the success of the curve reconstruction. The accuracy of the curve reconstruction 
		can vary depending on the orientation of the object within the calibration volume. 
		If you understand a bit about how the curve reconstruction relates to the epipolar 
		line then you can find an orientation that will afford you the most accuracy.
	</p>
	<p>
		Stereo reconstruction requires corresponding points between different views. Curves 
		complicate this a bit because while the first and last point are clearly corresponding, 
		how do the points along one curve correpond to those along the other? You might think 
		it would be as simple as matching points that are at same relative position along 
		each curve's length (i.e. a point halfway along one curve corresponds to a point 
		halfway along the other). This turns out not to be the case because of how the 
		different views distort the projection of the curve onto the image plane.
	</p>
	<p>
		To solve this problem, StereoMorph identifies corresponding points by taking a point 
		along the curve in one view and finding a point along the curve in the other view 
		that intersects with the epipolar line of the first point. Basically, using information 
		from the calibration to identify the corresponding points. This works best where 
		the epipolar line is perpendicular to the curve because there is a clear, single 
		point of intersection. At the other extreme, if the epipolar line is parallel to 
		the curve there can be several points on the curve at a similar distance from the 
		epipolar line.
	</p>
	<p>
		For this reason, if you are collecting curves it is best to avoid orienting the 
		object so that the epipolar line is less than 10 degrees relative to the curve. 
		This may not be avoidable in some cases but it can at least be minimized. The 
		images below show the same curve digitized for two different orientations of the 
		specimen. The left is a better orientation of the specimen for this curve because 
		the epipolar line is nearly 90 degrees to the curve along its entire length. In 
		contrast, with the orientation on the right the epipolar line will be nearly tangent 
		to some portions of the curve.
	</p>

	<img width='700px' class='center' src='../../img/tutorials/stereomorph/good_bad_epipolar_curve.jpg' />
	<div class='img_caption' >
		The same curve digitized for different orientations of the specimen. Left is a 
		better orientation for this curve since the epipolar line is less tangent to any 
		one portion of the curve.
	</div>

	<p>
		You can easily predict the orientation of the epipolar line for a particular camera 
		arrangement. Imagine a line extending straight out from each camera as in the two 
		arrangements below. Then imagine what each of these lines would look like in the 
		other camera view (these are the epipolar lines for the center of the image in 
		each view). These lines represent generally how the epipolar line will be oriented 
		within each view.
	</p>

	<img width='700px' class='center' src='../../img/tutorials/stereomorph/camera_angles_epipolar.jpg' />

	<p>
		Once you've finished digitizing all of the shapes you'd like to digitize be sure to click "Save".
	</p>

	<div class='tutorial_previous_next' >
		<div style="float:left"><strong>Previous:</strong> <a href="digitizing_landmarks.html" >Digitizing landmarks</a></div>
		<div style="float:right"><strong>Next:</strong> <a href="digitizing_moving.html" >Moving between images</a></div>
	</div>
</div>
		</div>

		<div id='footer' class='footer' >
			<div style='float:left;' >© 2017 Aaron Olsen. All rights reserved.<br><br></div>
			<div style='float:right;' >Design and photographs by Aaron Olsen.</div>
			<div style='float:left;background-color:;' >The material on this site is based upon work supported by the National Science Foundation (DGE-1144082, DGE-0903637, DBI-1612230). Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation.</div>
		</div>

	</div>

</body>
<script src="../../js/sharedfunctions2.js" type="text/javascript" ></script>