<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<title>StereoMorph - Calibrating stereo cameras</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
<link rel="shortcut icon" href="../../img/favicon.png"/>
<link href="../../css/stylesheet2.css" rel="stylesheet" type="text/css">

<body>
	<div id='container' class='container'>

		<div id='header' class='header' >
			<div style='position:relative;' >
				<img id='header_image' style='float:right;' src='../../img/headers/American Wigeon.jpg' />
				<div id='header_image_caption' style='color:white' class='header_image_caption' >
					American Wigeon
				</div>
			</div>
		</div>

		<div id='linksidebar' class='linksidebar' >
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../about_me.html'>About me</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../current_projects.html'>Current projects</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../software.html'>Software</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../tutorials/visualization3d.html'>Tutorials</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/visualization3d.html'>3D Visualization</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/morphometrics.html'>Shape analysis</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/motion.html'>Motion</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/mechanisms.html'>Mechanism models</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph.html'>StereoMorph User Guide</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/installing_stereomorph.html'>1 Getting started</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/choosing_cameras_general.html'>2 Choosing cameras</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/choose_checkerboard_size.html'>3 Creating a checkerboard</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/arranging_cameras_photography.html'>4 Arranging the cameras</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/calibration_general.html'>5 Calibrating stereo cameras</a>
			</div>
				<div class='linksidebar_sub3link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/calibration_general.html'>5.1 General calibration steps and parameters</a>
			</div>
				<div class='linksidebar_sub3link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/calibration_photographs.html'>5.2 Calibrating with photographs</a>
			</div>
				<div class='linksidebar_sub3link_u' >
				<a class='linksidebar_link_u' href='../../tutorials/stereomorph/calibration_video.html'>5.3 Calibrating with video</a>
			</div>
				<div class='linksidebar_sub3link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/calibration_coefficients.html'>5.4 Calculating calibration coefficients</a>
			</div>
				<div class='linksidebar_sub3link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/calibration_accuracy.html'>5.5 Determining calibration accuracy</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/photographing_objects.html'>6 Photographing objects</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/digitizing_video.html'>7 Digitizing application</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/reconstructing_landmarks.html'>8 Reconstruction</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/visualizing_shape.html'>9 Visualizing shape data</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/reflect_missing.html'>10 Reflecting bilateral landmarks</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/align_bilateral.html'>11 Aligning bilateral landmarks</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/extracting_frames.html'>12 Additional features</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/citing.html'>13 Citing StereoMorph</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/acknowledgements.html'>14 Acknowledgements</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/knex/large_u_joint.html'>K'nex models</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../contact.html'>Contact</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../cv.html'>CV</a>
			</div>
		</div>

		<div id='maincontent' class='maincontent' >

			<div id='pagetrail' class='pagetrail' ><a href="../../about_me.html">home</a>&nbsp;&nbsp;&nbsp;>&nbsp;&nbsp;&nbsp;<a href="../../tutorials/visualization3d.html">tutorials</a>&nbsp;&nbsp;&nbsp;>&nbsp;&nbsp;&nbsp;<a href="../../tutorials/stereomorph.html">stereomorph user guide</a>&nbsp;&nbsp;&nbsp;>&nbsp;&nbsp;&nbsp;<a href="../../tutorials/stereomorph/calibration_general.html">5 calibrating stereo cameras</a>&nbsp;&nbsp;&nbsp;>&nbsp;&nbsp;&nbsp;5.3 calibrating with video</div>


<div class="maincontentfill">
	<h1>5.3 Calibrating with video</h1>
	<p>
		The following will show you how to call <span class='in_line_code'>calibrateCameras()</span> using a set of videos 
		from two or more camera views. This differs only slightly from 
		<a href='calibration_photographs.html' >calibrating with photographs</a> so much 
		of the previous section will apply here as well. Your videos will need to be 
		synchronized in order for the calibration to work properly (the first frame in all 
		views must correspond to the same point in time). StereoMorph does not currently 
		have tools to synchronize videos so this will have to be done using another program. 
		Also, make sure that you have completed the steps in 
		<a href='installing_ffmpeg.html' >installing ffmpeg</a> so that R can read the video files.
	</p>
	<p>
		1. Record video of the checkerboard pattern being moved and rotated throughout the 
		entire calibration space. It is essential that the checkerboard be moved throughout 
		the entire space or else reconstruction errors will be higher in some areas than 
		in others.
	</p>

	<img width='500px' class='center' src='../../img/tutorials/stereomorph/calibration_videos.jpg' />
	<div class='img_caption' >
		Four frames from video of a checkerboard at different positions and angles within 
		the calibration space, recorded from left and right camera views. Image credit: 
		Caine Delacy.
	</div>

	<p>
		2. Upload the videos into a single folder, naming each video file with the corresponding 
		camera view (e.g. "Left" and "Right" or "View 1" and "View 2"). If you'd 
		like to work through the example below, you can 
		<a href='../..//software/stereomorph/tutorial_files/Calibrate_videos.zip' >download an example set of calibration videos here (19 MB)</a>. 
		Unzip this folder and move it to your R working directory.
	</p>
	<p>
		3. Call the <span class='in_line_code'>calibrateCameras()</span> function. The call 
		for the set of example videos looks like this:
	</p>

<div class="code" ><pre class="code">
<span class="code_comment" ># Calibrate cameras from videos</span>
<span class="code_function" >calibrateCameras</span>(img.dir=<span class="code_quote" >'Calibrate_Videos'</span>, cal.file=<span class="code_quote" >'calibration.txt'</span>, 
     corner.dir=<span class="code_quote" >'Corners'</span>, sq.size=<span class="code_quote" >'63.42 mm'</span>, nx=<span class="code_numeric" >8</span>, ny=<span class="code_numeric" >4</span>, 
     verify.dir=<span class="code_quote" >'Verify'</span>, error.dir=<span class="code_quote" >'Errors'</span>, undistort=TRUE,
     num.aspects.read=<span class="code_numeric" >100</span>, fit.min.break=<span class="code_numeric" >2</span>, nlm.calls.max=<span class="code_numeric" >15</span>, 
     objective.min=<span class="code_numeric" >0.8</span>, max.sample.optim=<span class="code_numeric" >30</span>, num.sample.est=<span class="code_numeric" >20</span>, 
     num.aspects.sample=<span class="code_numeric" >8</span>, num.sample.sets=<span class="code_numeric" >3</span>, objective.min.break=<span class="code_numeric" >1.2</span>)
</pre></div>

	<p>
		The function will begin by trying to detect the corners in all of the calibration 
		images. You can see the detected corners by looking in the "Verify" folder.
	</p>

	<img width='500px' class='center' src='../../img/tutorials/stereomorph/detected_corners_video.jpg' />
	<div class='img_caption' >
		Detected corners in a video frame. The red circle indicates the first corner and 
		the blue circle indicates the last corner. Image credit: Caine Delacy.
	</div>

	<p>
		For the example set, the corners are detected for 83 frames in the left view and 
		for 80 frames in the right view. However, there are only 68 frames for which the 
		corners were detected in both views. Note that we can only use the corners detected 
		in both views to estimate the calibration coefficients so we want to make sure that 
		not only are the corners detected in enough frames but that they are detected in 
		both views for a sufficient number of frames. Sixty-eight frames are more than 
		sufficient for a good calibration.
	</p>

	<div class='tutorial_previous_next' >
		<div style="float:left"><strong>Previous:</strong> <a href="calibration_photographs.html" >Calibrating with photographs</a></div>
		<div style="float:right"><strong>Next:</strong> <a href="calibration_coefficients.html" >Calculating calibration coefficients</a></div>
	</div>
</div>
		</div>

		<div id='footer' class='footer' >
			<div style='float:left;' >Â© 2019 Aaron Olsen. All rights reserved.<br><br></div>
			<div style='float:right;' >Design and photographs by Aaron Olsen.</div>
			<div style='float:left;background-color:;' >The material on this site is based upon work supported by the National Science Foundation (DGE-1144082, DGE-0903637, DBI-1612230). Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation.</div>
		</div>

	</div>

</body>
<script src="../../js/sharedfunctions2.js" type="text/javascript" ></script>