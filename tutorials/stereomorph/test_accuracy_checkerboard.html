<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<title>StereoMorph - Additional features</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
<link rel="shortcut icon" href="../../img/favicon.png"/>
<link href="../../css/stylesheet2.css" rel="stylesheet" type="text/css">

<body>
	<div id='container' class='container'>

		<div id='header' class='header' >
			<div style='position:relative;' >
				<img id='header_image' style='float:right;' src='../../img/headers/American Wigeon.jpg' />
				<div id='header_image_caption' style='color:white' class='header_image_caption' >
					American Wigeon
				</div>
			</div>
		</div>

		<div id='linksidebar' class='linksidebar' >
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../about_me.html'>About me</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../current_projects.html'>Current projects</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../software.html'>Software</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../tutorials/visualization3d.html'>Tutorials</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/visualization3d.html'>3D Visualization</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/morphometrics.html'>Shape analysis</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/motion.html'>Motion</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/mechanisms.html'>Mechanism models</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph.html'>StereoMorph User Guide</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/installing_stereomorph.html'>1 Getting started</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/choosing_cameras_general.html'>2 Choosing cameras</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/choose_checkerboard_size.html'>3 Creating a checkerboard</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/arranging_cameras_photography.html'>4 Arranging the cameras</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/calibration_general.html'>5 Calibrating stereo cameras</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/photographing_objects.html'>6 Photographing objects</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/digitizing_video.html'>7 Digitizing application</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/reconstructing_landmarks.html'>8 Reconstruction</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/visualizing_shape.html'>9 Visualizing shape data</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/reflect_missing.html'>10 Reflecting bilateral landmarks</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/align_bilateral.html'>11 Aligning bilateral landmarks</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/extracting_frames.html'>12 Additional features</a>
			</div>
				<div class='linksidebar_sub3link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/extracting_frames.html'>12.1 Extracting video frames</a>
			</div>
				<div class='linksidebar_sub3link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/extracting_synchronized.html'>12.2 Extracting synchronized frames</a>
			</div>
				<div class='linksidebar_sub3link_u' >
				<a class='linksidebar_link_u' href='../../tutorials/stereomorph/test_accuracy_checkerboard.html'>12.3 Testing accuracy with checkerboard</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/citing.html'>13 Citing StereoMorph</a>
			</div>
			<div class='linksidebar_sub2link' >
				<a class='linksidebar_link' href='../../tutorials/stereomorph/acknowledgements.html'>14 Acknowledgements</a>
			</div>
			<div class='linksidebar_sublink' >
				<a class='linksidebar_link' href='../../tutorials/knex/large_u_joint.html'>K'nex models</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../contact.html'>Contact</a>
			</div>
			<div class='linksidebar_mainlink' >
				<a class='linksidebar_link' href='../../cv.html'>CV</a>
			</div>
		</div>

		<div id='maincontent' class='maincontent' >

			<div id='pagetrail' class='pagetrail' ><a href="../../about_me.html">home</a>&nbsp;&nbsp;&nbsp;>&nbsp;&nbsp;&nbsp;<a href="../../tutorials/visualization3d.html">tutorials</a>&nbsp;&nbsp;&nbsp;>&nbsp;&nbsp;&nbsp;<a href="../../tutorials/stereomorph.html">stereomorph user guide</a>&nbsp;&nbsp;&nbsp;>&nbsp;&nbsp;&nbsp;<a href="../../tutorials/stereomorph/extracting_frames.html">12 additional features</a>&nbsp;&nbsp;&nbsp;>&nbsp;&nbsp;&nbsp;12.3 testing accuracy with checkerboard</div>


<div class="maincontentfill">
	<h1>12.3 Testing accuracy using a second checkerboard</h1>
	<p>
		The section <a href='calibration_general.html' >Calibrating stereo cameras</a> showed 
		how to calibrate a stereo camera setup, by photographing a checkerboard pattern at 
		different positions and angles in the calibration volume and using the StereoMorph 
		function <span class='in_line_code'>calibrateCameras()</span> to estimate the 
		calibration coefficients and test the calibration accuracy. Recall however that by 
		<a href='calibration_accuracy.html' >determining the calibration accuracy</a> 
		using the same checkerboard used in the calibration it isn't possible to test whether 
		the calibration has the correct scaling (the checkerboard square size is identical 
		throughout).
	</p>
	<p>
		This section will demonstrate how to use the StereoMorph function <span class='in_line_code'>testCalibration()</span> 
		to test the calibration accuracy, using a checkerboard with a different square size. 
		This serves as a more independent test of the calibration accuracy. This section 
		will be brief since the steps for using <span class='in_line_code'>testCalibration()</span> 
		are nearly identical to those for <span class='in_line_code'>calibrateCameras()</span> 
		(refer to <a href='calibration_photographs.html' >Calibrating stereo cameras</a> 
		for more details on <span class='in_line_code'>calibrateCameras()</span>).
	</p>
	<p>
		1. Begin by photographing a checkerboard in the calibration volume in the same 
		manner as for the calibration step.
	</p>

	<img width='700px' class='center' src='../../img/tutorials/stereomorph/test_calibration_images.jpg' />
	<div class='img_caption' >
		Examples of a test checkerboard photographed from two views at different positions 
		and angles within the calibration space.
	</div>

	<p>
		2. Upload the images into a folder, separating, the images from different views into 
		two different folders (e.g. "Left" and "Right", "View 1" and "View 2") just 
		like for the calibration step.
	</p>
	<p>
		If you'd like to try out the following code with an example dataset you can 
		<a href='../../software/stereomorph/tutorial_files/Test_calibration_set.zip' targe='_blank' >download this test calibration image set (3 MB)</a>. 
		This example set tests the scaling accuracy of the calibration performed in 
		<a href='calibration_photographs.html' >calibrating with photographs</a>. This 
		example set uses a checkerboard that differs both in square size (5.080 mm versus 
		6.35 mm) and the number of internal corners (7x6 versus 8x6). Unzip the folder and 
		move its contents into your current R working directory.
	</p>
	<p>
		3. Make sure the StereoMorph library is loaded.
	</p>

<div class="code" ><pre class="code">
<span class="code_comment" ># Load the StereoMorph package</span>
<span class="code_function" >library</span>(StereoMorph)
</pre></div>

	<p>
		4. Call <span class='in_line_code'>testCalibration()</span>.
	</p>

<div class="code" ><pre class="code">
<span class="code_comment" ># Test calibration against other checkerboard set</span>
test_cal <- <span class="code_function" >testCalibration</span>(img.dir=<span class="code_quote" >'Images'</span>, cal.file=<span class="code_quote" >'calibration.txt'</span>, 
   corner.dir=<span class="code_quote" >'Corners'</span>, sq.size=<span class="code_quote" >'5.080 mm'</span>, nx=<span class="code_numeric" >7</span>, ny=<span class="code_numeric" >6</span>, error.dir=<span class="code_quote" >'Errors'</span>, 
   verify.dir=<span class="code_quote" >'Verify'</span>)
</pre></div>

	<p>
		The basic input parameters are nearly identical to <span class='in_line_code'>calibrateCameras()</span>. 
		Here is a brief description of each parameter:
	</p>

<ul>
	<li><strong>img.dir</strong>: The folder containing the checkerboard images, each view in a separate folder.</li>
	<li><strong>cal.file</strong>: The calibration file previously created by <span class='in_line_code'>calibrateCameras()</span>.</li>
	<li><strong>corner.dir</strong>: A folder where the corners will be saved. If this folder does not exist, a new folder will automatically be created.</li>
	<li><strong>sq.size</strong>: The size of the squares along with the units (length along any one side).</li>
	<li><strong>nx</strong>: The number of internal corners along one dimension (the choice of which is <strong>nx</strong> and <strong>ny</strong> is arbitrary but must be consistent throughout).</li>
	<li><strong>ny</strong>: The number of internal corners along the other dimension.</li>
	<li><strong>error.dir</strong>: A folder in which to save the error diagnostics plots. Can be omitted to just print error summary in console.</li>
	<li><strong>verify.dir</strong>: (Optional) A folder where images will be saved that show the detected corners. If this folder does not exist, a new folder will automatically be created.</li>
</ul>

	<p>
		Just as in the calibration step, it's important to review the images in <strong>verify.dir</strong> 
		and make sure that the corners are being returned in the same order for all of the 
		images (the first corner is indicated by a red circle). If your cameras are arranged 
		such that one view is upside-down relative to the other (if <strong>flip.view</strong> was 
		TRUE for the calibration) you don't have to specify that as an input parameter. The 
		function will detect this setting from the calibration file.
	</p>
	<p>
		The function returns the accuracy test in the same way as the calibration step. Several 
		error diagnostic plots are created if <strong>error.dir</strong> is specified. Additionally, 
		the function prints an error summary in the console:
	</p>

<div class="code" ><pre class="code">
dltTestCalibration Summary
     Number of aspects: <span class="code_numeric" >6</span>
     Number of views: <span class="code_numeric" >2</span>
     Square size: <span class="code_numeric" >5.08</span> mm
     Number of points per aspect: <span class="code_numeric" >42</span>
     Aligned ideal to reconstructed (AITR) point position errors:
          AITR RMS Errors (X, Y, Z): <span class="code_numeric" >0.0148</span> mm, <span class="code_numeric" >0.0220</span> mm, <span class="code_numeric" >0.0212</span> mm
          Mean AITR Distance Error: <span class="code_numeric" >0.0309</span> mm
          AITR Distance RMS Error: <span class="code_numeric" >0.0346</span> mm
     Inter-point distance (IPD) errors:
          IPD RMS Error: <span class="code_numeric" >0.0316</span> mm
          IPD Mean Absolute Error: <span class="code_numeric" >0.0237</span> mm
          Mean IPD error: -<span class="code_numeric" >0.0161</span> mm
     Adjacent-pair distance errors:
          Mean adjacent-pair distance error: <span class="code_numeric" >0.000650</span> mm
          Mean adjacent-pair absolute distance error: <span class="code_numeric" >0.0167</span> mm
          SD of adjacent-pair distance error: <span class="code_numeric" >0.0188</span> mm
     Epipolar errors:
          Epipolar RMS Error: <span class="code_numeric" >0.304</span> px
          Epipolar Mean Error: <span class="code_numeric" >0.304</span> px
          Epipolar Max Error: <span class="code_numeric" >0.970</span> px
          SD of Epipolar Error: <span class="code_numeric" >0.209</span> px
</pre></div>

	<p>
		The errors in this printed summary are fairly close to those from 
		<a href='calibration_accuracy.html' >the calibration step</a>. 
		One important error measure to note here is the "Mean IPD error". This is 
		the mean error of all the inter-point distance (length measurements) among points 
		on the checkerboard. Since this is not an absolute mean error, it should be close 
		to zero because the error should not be biased (i.e. the calibration should not 
		consistently under- or overestimate the lengths). Here it differs from 0.0 by 0.016 mm 
		(16 microns). We can call this negligible since it is below the pixel resolution 
		threshold for this setup (at least 30 microns/pixel).
	</p>

	<div class='tutorial_previous_next' >
		<div style="float:left"><strong>Previous:</strong> <a href="extracting_synchronized.html" >Extracting synchronized frames</a></div>
		<div style="float:right"><strong>Next:</strong> <a href="citing.html" >Citing StereoMorph</a></div>
	</div>
</div>
		</div>

		<div id='footer' class='footer' >
			<div style='float:left;' >© 2019 Aaron Olsen. All rights reserved.<br><br></div>
			<div style='float:right;' >Design and photographs by Aaron Olsen.</div>
			<div style='float:left;background-color:;' >The material on this site is based upon work supported by the National Science Foundation (DGE-1144082, DGE-0903637, DBI-1612230). Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation.</div>
		</div>

	</div>

</body>
<script src="../../js/sharedfunctions2.js" type="text/javascript" ></script>